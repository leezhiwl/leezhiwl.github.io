<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://leezhiwl.GitHub.io</id>
    <title>利用Python进行数据分析</title>
    <updated>2020-10-10T14:54:56.340Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://leezhiwl.GitHub.io"/>
    <link rel="self" href="https://leezhiwl.GitHub.io/atom.xml"/>
    <subtitle>温故而知新@leezhiwl</subtitle>
    <logo>https://leezhiwl.GitHub.io/images/avatar.png</logo>
    <icon>https://leezhiwl.GitHub.io/favicon.ico</icon>
    <rights>All rights reserved 2020, 利用Python进行数据分析</rights>
    <entry>
        <title type="html"><![CDATA[去哪儿网数据清洗]]></title>
        <id>https://leezhiwl.GitHub.io/post/qu-na-er-wang-shu-ju-qing-xi/</id>
        <link href="https://leezhiwl.GitHub.io/post/qu-na-er-wang-shu-ju-qing-xi/">
        </link>
        <updated>2020-10-10T11:06:58.000Z</updated>
        <content type="html"><![CDATA[<!-- more -->
<!-- more -->
<h1>去哪儿网数据清理<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#一、数据清洗" data-toc-modified-id="一、数据清洗-1">一、数据清洗</a></span><ul class="toc-item"><li><span><a href="#1.-数据导入和概览" data-toc-modified-id="1.-数据导入和概览-1.1">1. 数据导入和概览</a></span></li></ul></li><li><span><a href="#二、数据预处理" data-toc-modified-id="二、数据预处理-2">二、数据预处理</a></span><ul class="toc-item"><li><span><a href="#1.-列名空字符去除" data-toc-modified-id="1.-列名空字符去除-2.1">1. 列名空字符去除</a></span></li><li><span><a href="#2.-重复值处理" data-toc-modified-id="2.-重复值处理-2.2">2. 重复值处理</a></span></li><li><span><a href="#3.-异常值处理" data-toc-modified-id="3.-异常值处理-2.3">3. 异常值处理</a></span></li><li><span><a href="#4.-缺失值处理" data-toc-modified-id="4.-缺失值处理-2.4">4. 缺失值处理</a></span></li><li><span><a href="#5.文本型数据的处理" data-toc-modified-id="5.文本型数据的处理-2.5">5.文本型数据的处理</a></span></li></ul></li></ul></div>
<h1 id="一-数据清洗">一、数据清洗</h1>
<h2 id="1-数据导入和概览">1. 数据导入和概览</h2>
<p>导入Python科学计算库：</p>
<pre><code class="language-python">import warnings  # 忽略warning错误
warnings.filterwarnings(&quot;ignore&quot;)  
</code></pre>
<pre><code class="language-python">import pandas as pd 
import matplotlib.pyplot as plt 
import seaborn as sns 

%matplotlib inline
# 此行代码必须单独一行，同行不可添加注释。作用：plot和figure可直接生成图形或画布 

sns.set_style({'font.sans-serif':['simhei','Arial']})
sns.set(style=&quot;white&quot;, palette=&quot;muted&quot;, color_codes=True) 
</code></pre>
<p>加载读取文件：</p>
<pre><code class="language-python">df = pd.read_csv('./qunar_freetrip.csv',index_col=0)
</code></pre>
<p>先查看一下行列数量：</p>
<pre><code class="language-python">df.shape
</code></pre>
<pre><code>(5100, 13)
</code></pre>
<p>简单浏览下数据：</p>
<pre><code class="language-python">df.head()
</code></pre>
<figure data-type="image" tabindex="1"><img src="attachment:image.png" alt="image.png" loading="lazy"></figure>
<p>查看数据结构(列名、行数、字段类型):</p>
<pre><code class="language-python">df.info()
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 5100 entries, 0 to 5099
Data columns (total 13 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   出发地     5098 non-null   object 
 1    目的地    5099 non-null   object 
 2   价格      5072 non-null   float64
 3   节省      5083 non-null   float64
 4   路线名     5100 non-null   object 
 5   酒店      5100 non-null   object 
 6   房间      5100 non-null   object 
 7   去程航司    5100 non-null   object 
 8   去程方式    5100 non-null   object 
 9   去程时间    5100 non-null   object 
 10  回程航司    5100 non-null   object 
 11  回程方式    5100 non-null   object 
 12  回程时间    5100 non-null   object 
dtypes: float64(2), object(11)
memory usage: 557.8+ KB
</code></pre>
<p>”出发地“、”目的地“、”价格“、”节省“ 四列有缺失值，需要清洗。</p>
<p>describe( )展示一些基本信息：</p>
<pre><code class="language-python">df.describe()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>价格</th>
      <th>节省</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5072.000000</td>
      <td>5083.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1765.714905</td>
      <td>474.139878</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2580.129644</td>
      <td>168.893780</td>
    </tr>
    <tr>
      <th>min</th>
      <td>578.000000</td>
      <td>306.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1253.000000</td>
      <td>358.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1632.000000</td>
      <td>436.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2028.250000</td>
      <td>530.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>179500.000000</td>
      <td>3500.000000</td>
    </tr>
  </tbody>
</table>
</div>
<p>”价格“和”节省“两列中数据的最大值异常大，需要判断是否为异常值。</p>
<p>查看有没有重复值：</p>
<pre><code class="language-python">df.duplicated().sum()
</code></pre>
<pre><code>100
</code></pre>
<p>有重复行，后续可直接删除。</p>
<p>再看看列名，列名中有空格，需要先去除：</p>
<pre><code class="language-python">df.columns
</code></pre>
<pre><code>Index(['出发地 ', ' 目的地', '价格 ', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式', '去程时间',
       '回程航司', '回程方式 ', '回程时间'],
      dtype='object')
</code></pre>
<h1 id="二-数据预处理">二、数据预处理</h1>
<h2 id="1-列名空字符去除">1. 列名空字符去除</h2>
<pre><code class="language-python">df.columns = [x.strip() for x in df.columns]
</code></pre>
<pre><code class="language-python">df.columns
</code></pre>
<pre><code>Index(['出发地', '目的地', '价格', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式', '去程时间',
       '回程航司', '回程方式', '回程时间'],
      dtype='object')
</code></pre>
<h2 id="2-重复值处理">2. 重复值处理</h2>
<pre><code class="language-python">df.duplicated().sum()
</code></pre>
<pre><code>100
</code></pre>
<pre><code class="language-python">df[df.duplicated()]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>454</th>
      <td>广州</td>
      <td>黄山</td>
      <td>1871.0</td>
      <td>492.0</td>
      <td>广州-黄山3天2晚 | 入住黄山汤口醉享主题酒店 + 南方航空往返机票</td>
      <td>黄山汤口醉享主题酒店 舒适型 4.8分/5分</td>
      <td>睫毛弯弯(大床) 大床 不含早 1间2晚</td>
      <td>南方航空 CZ3627</td>
      <td>直飞</td>
      <td>19:20-21:15</td>
      <td>南方航空 CZ3628</td>
      <td>直飞</td>
      <td>22:05-23:50</td>
    </tr>
    <tr>
      <th>649</th>
      <td>济南</td>
      <td>长沙</td>
      <td>1134.0</td>
      <td>360.0</td>
      <td>济南-长沙3天2晚 | 入住长沙喜迎宾华天大酒店 + 山东航空往返机票</td>
      <td>长沙喜迎宾华天大酒店 高档型 3.7分/5分</td>
      <td>特惠双间(特惠抢购)(... 双床 不含早 1间2晚</td>
      <td>山东航空 SC1185</td>
      <td>直飞</td>
      <td>18:40-20:50</td>
      <td>山东航空 SC1186</td>
      <td>直飞</td>
      <td>10:20-12:15</td>
    </tr>
    <tr>
      <th>685</th>
      <td>青岛</td>
      <td>重庆</td>
      <td>1474.0</td>
      <td>420.0</td>
      <td>青岛-重庆3天2晚 | 入住怡家丽景酒店重庆垫江店 + 山东航空/华夏航空往返机票</td>
      <td>怡家丽景酒店重庆垫江店 舒适型 4.3分/5分</td>
      <td>法式房(内宾)(无窗)... 大床 不含早 1间2晚</td>
      <td>山东航空 SC4709</td>
      <td>经停</td>
      <td>19:30-00:05</td>
      <td>华夏航空 G54710</td>
      <td>经停</td>
      <td>18:00-22:25</td>
    </tr>
    <tr>
      <th>852</th>
      <td>北京</td>
      <td>哈尔滨</td>
      <td>1450.0</td>
      <td>368.0</td>
      <td>北京-哈尔滨3天2晚 | 入住哈尔滨水逸城市酒店 + 南方航空/大新华航空往返机票</td>
      <td>哈尔滨水逸城市酒店 舒适型 4.6分/5分</td>
      <td>标准间-【预付特惠】独... 双床 双早 1间2晚</td>
      <td>南方航空 CZ6202</td>
      <td>直飞</td>
      <td>22:20-00:20</td>
      <td>大新华航空 CN7150</td>
      <td>直飞</td>
      <td>22:50-00:55</td>
    </tr>
    <tr>
      <th>922</th>
      <td>北京</td>
      <td>长沙</td>
      <td>1289.0</td>
      <td>334.0</td>
      <td>北京-长沙3天2晚 | 入住浏阳市华尔宫大酒店 + 海南航空/南方航空往返机票</td>
      <td>浏阳市华尔宫大酒店 3.8分/5分</td>
      <td>豪华双人间(双床) 双床 不含早 1间2晚</td>
      <td>海南航空 HU7135</td>
      <td>直飞</td>
      <td>17:45-20:30</td>
      <td>南方航空 CZ3855</td>
      <td>直飞</td>
      <td>22:55-01:10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5045</th>
      <td>杭州</td>
      <td>丽江</td>
      <td>2872.0</td>
      <td>718.0</td>
      <td>杭州-丽江3天2晚 | 入住丽江松竹居客栈玉观音店 + 长龙航空/首都航空往返机票</td>
      <td>丽江松竹居客栈玉观音店 高档型 4.6分/5分</td>
      <td>特惠房(大床) 大床 不含早 1间2晚</td>
      <td>长龙航空 GJ8869</td>
      <td>经停</td>
      <td>08:50-13:35</td>
      <td>首都航空 JD5192</td>
      <td>直飞</td>
      <td>13:00-16:15</td>
    </tr>
    <tr>
      <th>5066</th>
      <td>哈尔滨</td>
      <td>西安</td>
      <td>1843.0</td>
      <td>450.0</td>
      <td>哈尔滨-西安3天2晚 | 入住西安铁通商务酒店贵宾楼 + 天津航空/东方航空往返...</td>
      <td>西安铁通商务酒店贵宾楼 舒适型 4.2分/5分</td>
      <td>标准间(持房卡尊享清凉... 双床 不含早 1间2晚</td>
      <td>天津航空 GS7584</td>
      <td>经停</td>
      <td>12:30-17:40</td>
      <td>东方航空 MU2211</td>
      <td>经停</td>
      <td>08:45-13:25</td>
    </tr>
    <tr>
      <th>5068</th>
      <td>南京</td>
      <td>成都</td>
      <td>1922.0</td>
      <td>552.0</td>
      <td>南京-成都3天2晚 | 入住成都伊丽特酒店 + 东方航空/西藏航空往返机票</td>
      <td>成都伊丽特酒店 高档型 4.5分/5分</td>
      <td>行政标准间-含早立即确... 双床 双早 1间2晚</td>
      <td>东方航空 MU2880</td>
      <td>直飞</td>
      <td>21:55-00:35</td>
      <td>西藏航空 TV9839</td>
      <td>直飞</td>
      <td>06:30-08:55</td>
    </tr>
    <tr>
      <th>5081</th>
      <td>上海</td>
      <td>青岛</td>
      <td>769.0</td>
      <td>354.0</td>
      <td>上海-青岛3天2晚 | 入住青岛金中太大酒店 + 春秋航空/吉祥航空往返机票</td>
      <td>青岛金中太大酒店 舒适型 4.8分/5分</td>
      <td>特惠大床房[无早] 大床 不含早 1间2晚</td>
      <td>春秋航空 9C8853</td>
      <td>直飞</td>
      <td>19:50-21:35</td>
      <td>吉祥航空 HO1242</td>
      <td>直飞</td>
      <td>23:05-00:35</td>
    </tr>
    <tr>
      <th>5095</th>
      <td>宁波</td>
      <td>九寨沟</td>
      <td>2085.0</td>
      <td>562.0</td>
      <td>宁波-九寨沟3天2晚 | 入住黑水县达古冰山国际大酒店 + 成都航空/四川航空往...</td>
      <td>黑水县达古冰山国际大酒店 豪华型 3.9分/5分</td>
      <td>B区豪华标间(双床) 双床 不含早 1间2晚</td>
      <td>成都航空 EU2730</td>
      <td>经停</td>
      <td>19:45-00:45</td>
      <td>四川航空 3U8927</td>
      <td>经停</td>
      <td>07:55-12:15</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 13 columns</p>
</div>
<p>判断有100行重复数据，直接进行去重。</p>
<pre><code class="language-python">df.drop_duplicates(inplace=True)
</code></pre>
<pre><code class="language-python">df.shape
</code></pre>
<pre><code>(5000, 13)
</code></pre>
<h2 id="3-异常值处理">3. 异常值处理</h2>
<p>对价格和节省两列数据进行异常值处理：</p>
<pre><code class="language-python">df.describe()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>价格</th>
      <th>节省</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4972.000000</td>
      <td>4983.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1767.782381</td>
      <td>474.490869</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2604.329780</td>
      <td>169.148391</td>
    </tr>
    <tr>
      <th>min</th>
      <td>578.000000</td>
      <td>306.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1253.000000</td>
      <td>358.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1633.000000</td>
      <td>436.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2031.000000</td>
      <td>532.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>179500.000000</td>
      <td>3500.000000</td>
    </tr>
  </tbody>
</table>
</div>
<p>找出价格异常值：</p>
<pre><code class="language-python">df[abs((df.价格-df.价格.mean())/df.价格.std())&gt;3]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2792</th>
      <td>杭州</td>
      <td>九寨沟</td>
      <td>179500.0</td>
      <td>538.0</td>
      <td>杭州-九寨沟3天2晚 | 入住九寨沟九乡宾馆 + 成都航空/长龙航空往返机票</td>
      <td>九寨沟九乡宾馆 舒适型 4.3分/5分</td>
      <td>特惠房(双床) 双床 不含早 1间2晚</td>
      <td>成都航空 EU2206</td>
      <td>经停</td>
      <td>20:30-01:00</td>
      <td>长龙航空 GJ8680</td>
      <td>经停</td>
      <td>20:25-00:50</td>
    </tr>
  </tbody>
</table>
</div>
<p>删除价格异常值：</p>
<pre><code class="language-python">df.drop(df[abs((df.价格-df.价格.mean())/df.价格.std())&gt;3].index,inplace=True)
</code></pre>
<p>找出节省异常值：</p>
<pre><code class="language-python">df.head(15)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>哈尔滨</td>
      <td>北海</td>
      <td>2208.0</td>
      <td>650.0</td>
      <td>哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票</td>
      <td>北海祥丰嘉年华大酒店 舒适型 4.7分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8741</td>
      <td>直飞</td>
      <td>17:10-21:50</td>
      <td>春秋航空 9C8742</td>
      <td>直飞</td>
      <td>10:20-15:05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1145.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票</td>
      <td>7天酒店丽江古城中心店 经济型 4.0分/5分</td>
      <td>经济房-不含早-限时特... 其他 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>广州</td>
      <td>沈阳</td>
      <td>2702.0</td>
      <td>618.0</td>
      <td>广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票</td>
      <td>沈阳中煤宾馆 舒适型 4.5分/5分</td>
      <td>大床间(内宾) 大床 双早 1间2晚</td>
      <td>南方航空 CZ6384</td>
      <td>直飞</td>
      <td>08:05-11:45</td>
      <td>深圳航空 ZH9652</td>
      <td>经停</td>
      <td>08:20-13:05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>上海</td>
      <td>九寨沟</td>
      <td>1954.0</td>
      <td>484.0</td>
      <td>上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票</td>
      <td>红原芸谊大酒店 舒适型 4.6分/5分</td>
      <td>豪华双床房[双早] 双床 双早 1间2晚</td>
      <td>成都航空 EU6678</td>
      <td>直飞</td>
      <td>21:55-01:15</td>
      <td>成都航空 EU6677</td>
      <td>直飞</td>
      <td>17:45-20:35</td>
    </tr>
    <tr>
      <th>4</th>
      <td>广州</td>
      <td>天津</td>
      <td>1608.0</td>
      <td>422.0</td>
      <td>广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票</td>
      <td>天津逸海明珠大酒店 高档型 4.1分/5分</td>
      <td>豪华双床房(预付) 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2787</td>
      <td>直飞</td>
      <td>06:55-10:00</td>
      <td>海南航空 HU7201</td>
      <td>直飞</td>
      <td>20:15-23:25</td>
    </tr>
    <tr>
      <th>5</th>
      <td>长春</td>
      <td>青岛</td>
      <td>1580.0</td>
      <td>390.0</td>
      <td>长春-青岛3天2晚 | 入住青岛康大豪生大酒店 + 南方航空往返机票</td>
      <td>青岛康大豪生大酒店 豪华型 4.6分/5分</td>
      <td>精选房(大床)[酒店★... 大床 不含早 1间2晚</td>
      <td>南方航空 CZ3938</td>
      <td>直飞</td>
      <td>20:00-21:55</td>
      <td>南方航空 CZ3963</td>
      <td>直飞</td>
      <td>15:40-17:30</td>
    </tr>
    <tr>
      <th>6</th>
      <td>济南</td>
      <td>九寨沟</td>
      <td>1625.0</td>
      <td>396.0</td>
      <td>济南-九寨沟3天2晚 | 入住阿坝松潘松林酒店 + 中国国航/成都航空往返机票</td>
      <td>阿坝松潘松林酒店 舒适型 4.3分/5分</td>
      <td>豪华标准间(双床) 双床 不含早 1间2晚</td>
      <td>中国国航 CA4528</td>
      <td>直飞</td>
      <td>21:00-23:30</td>
      <td>成都航空 EU2719</td>
      <td>直飞</td>
      <td>06:55-09:25</td>
    </tr>
    <tr>
      <th>7</th>
      <td>宁波</td>
      <td>重庆</td>
      <td>1673.0</td>
      <td>404.0</td>
      <td>宁波-重庆3天2晚 | 入住重庆运通假日酒店汽博中心店 + 南方航空/四川航空往...</td>
      <td>重庆运通假日酒店汽博中心店 舒适型 4.3分/5分</td>
      <td>特惠房(大床) 大床 双早 1间2晚</td>
      <td>南方航空 CZ8116</td>
      <td>直飞</td>
      <td>17:15-19:40</td>
      <td>四川航空 3U8983</td>
      <td>直飞</td>
      <td>06:55-09:35</td>
    </tr>
    <tr>
      <th>8</th>
      <td>哈尔滨</td>
      <td>南京</td>
      <td>1170.0</td>
      <td>340.0</td>
      <td>哈尔滨-南京3天2晚 | 入住维也纳酒店南京南站汇景店 + 吉祥航空/厦门航空往...</td>
      <td>维也纳酒店南京南站汇景店 舒适型 4.4分/5分</td>
      <td>特惠大床房（无窗）[双... 大床 双早 1间2晚</td>
      <td>吉祥航空 HO1651</td>
      <td>直飞</td>
      <td>17:10-20:00</td>
      <td>厦门航空 MF8067</td>
      <td>直飞</td>
      <td>19:40-22:25</td>
    </tr>
    <tr>
      <th>9</th>
      <td>深圳</td>
      <td>厦门</td>
      <td>1311.0</td>
      <td>350.0</td>
      <td>深圳-厦门3天2晚 | 入住厦门泊旅时尚酒店会展中心店 + 海南航空往返机票</td>
      <td>厦门泊旅时尚酒店会展中心店 舒适型 4.0分/5分</td>
      <td>时尚标准双床房 双床 双早 1间2晚</td>
      <td>海南航空 HU7065</td>
      <td>直飞</td>
      <td>07:30-08:40</td>
      <td>海南航空 HU7066</td>
      <td>直飞</td>
      <td>15:30-16:40</td>
    </tr>
    <tr>
      <th>10</th>
      <td>厦门</td>
      <td>沈阳</td>
      <td>2231.0</td>
      <td>606.0</td>
      <td>厦门-沈阳3天2晚 | 入住沈阳东方银座国际酒店 + 深圳航空/海南航空往返机票</td>
      <td>沈阳东方银座国际酒店 高档型 4.4分/5分</td>
      <td>高级大床房(空气清新房... 大床 不含早 1间2晚</td>
      <td>深圳航空 ZH9704</td>
      <td>经停</td>
      <td>17:20-22:10</td>
      <td>海南航空 HU7048</td>
      <td>直飞</td>
      <td>14:15-17:45</td>
    </tr>
    <tr>
      <th>11</th>
      <td>哈尔滨</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>472.0</td>
      <td>哈尔滨-长沙3天2晚 | 入住长沙艾玛连锁酒店 + 海南航空/奥凯航空往返机票</td>
      <td>长沙艾玛连锁酒店 舒适型 3.7分/5分</td>
      <td>豪华双人间-不含早（预... 双床 不含早 1间2晚</td>
      <td>海南航空 HU7726</td>
      <td>经停</td>
      <td>16:25-22:05</td>
      <td>奥凯航空 BK2849</td>
      <td>经停</td>
      <td>07:15-12:50</td>
    </tr>
    <tr>
      <th>12</th>
      <td>重庆</td>
      <td>厦门</td>
      <td>1780.0</td>
      <td>486.0</td>
      <td>重庆-厦门3天2晚 | 入住宜尚酒店厦门机场高科技园店 + 西藏航空/厦门航空往...</td>
      <td>宜尚酒店厦门机场高科技园店 舒适型 4.5分/5分</td>
      <td>商务大床房 大床 双早 1间2晚</td>
      <td>西藏航空 TV9869</td>
      <td>直飞</td>
      <td>18:35-21:10</td>
      <td>厦门航空 MF8403</td>
      <td>经停</td>
      <td>06:50-10:45</td>
    </tr>
    <tr>
      <th>13</th>
      <td>杭州</td>
      <td>西双版纳</td>
      <td>1665.0</td>
      <td>516.0</td>
      <td>杭州-西双版纳3天2晚 | 入住西双版纳辉煌都畅大饭店 + 长龙航空/首都航空往...</td>
      <td>西双版纳辉煌都畅大饭店 3.9分/5分</td>
      <td>高级双床房[无早] 双床 不含早 1间2晚</td>
      <td>长龙航空 GJ8823</td>
      <td>经停</td>
      <td>13:55-18:55</td>
      <td>首都航空 JD5788</td>
      <td>直飞</td>
      <td>21:40-00:50</td>
    </tr>
    <tr>
      <th>14</th>
      <td>青岛</td>
      <td>长沙</td>
      <td>1784.0</td>
      <td>450.0</td>
      <td>青岛-长沙3天2晚 | 入住林之源酒店长沙井湾子店 + 青岛航/幸福航空往返机票</td>
      <td>林之源酒店长沙井湾子店 舒适型 4.3分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>青岛航 QW9775</td>
      <td>直飞</td>
      <td>06:20-08:40</td>
      <td>幸福航空 JR2769</td>
      <td>直飞</td>
      <td>06:40-09:05</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">(df.价格&gt;df.节省).sum()
</code></pre>
<pre><code>4951
</code></pre>
<p>说明有48行票价优惠比原价高，不合常理，判断为异常值，数据较少，也可以直接去除。</p>
<p>删除节省列异常值：</p>
<pre><code class="language-python">df.drop(df[df.价格&lt;df.节省].index,inplace=True)
</code></pre>
<p>检验删除异常值后的数据基本特征：</p>
<pre><code class="language-python">df.describe()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>价格</th>
      <th>节省</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4968.000000</td>
      <td>4979.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1732.514090</td>
      <td>472.779675</td>
    </tr>
    <tr>
      <th>std</th>
      <td>653.148583</td>
      <td>154.366206</td>
    </tr>
    <tr>
      <th>min</th>
      <td>578.000000</td>
      <td>306.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1253.750000</td>
      <td>358.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1633.000000</td>
      <td>436.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2031.000000</td>
      <td>530.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6279.000000</td>
      <td>1640.000000</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="4-缺失值处理">4. 缺失值处理</h2>
<pre><code class="language-python">df.isnull().sum()
</code></pre>
<pre><code>出发地      2
目的地      1
价格      28
节省      17
路线名      0
酒店       0
房间       0
去程航司     0
去程方式     0
去程时间     0
回程航司     0
回程方式     0
回程时间     0
dtype: int64
</code></pre>
<pre><code class="language-python"># 查看出发地缺失值行
df[df.出发地.isnull()]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1864</th>
      <td>NaN</td>
      <td>烟台</td>
      <td>647.0</td>
      <td>348.0</td>
      <td>大连-烟台3天2晚 | 入住烟台海阳黄金海岸大酒店 + 幸福航空/天津航空往返机票</td>
      <td>烟台海阳黄金海岸大酒店 3.7分/5分</td>
      <td>海景标准间(内宾)[双... 双床 双早 1间2晚</td>
      <td>幸福航空 JR1582</td>
      <td>直飞</td>
      <td>10:05-11:05</td>
      <td>天津航空 GS6402</td>
      <td>直飞</td>
      <td>16:30-17:25</td>
    </tr>
    <tr>
      <th>1930</th>
      <td>NaN</td>
      <td>西安</td>
      <td>1030.0</td>
      <td>326.0</td>
      <td>济南-西安3天2晚 | 入住西安丝路秦国际青年旅舍钟楼回民街店 + 华夏航空往返...</td>
      <td>西安丝路秦国际青年旅舍钟楼回民街店 经济型 4.4分/5分</td>
      <td>标准间（独卫）-吃货天... 双床 不含早 1间2晚</td>
      <td>华夏航空 G54963</td>
      <td>直飞</td>
      <td>07:10-08:55</td>
      <td>华夏航空 G58858</td>
      <td>直飞</td>
      <td>23:10-00:55</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python"># 路线名的前两个字为出发地
df.loc[df.出发地.isnull(),&quot;出发地&quot;] =  [x[:2] for x in df.loc[df.出发地.isnull(),&quot;路线名&quot;]]
</code></pre>
<pre><code class="language-python">df.出发地.isnull().sum()
</code></pre>
<pre><code>0
</code></pre>
<pre><code class="language-python"># 查看目的地缺失值行
df[df.目的地.isnull()]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1875</th>
      <td>深圳</td>
      <td>NaN</td>
      <td>2149.0</td>
      <td>494.0</td>
      <td>深圳-大连3天2晚 | 入住大连黄金山大酒店 + 南方航空/东海往返机票</td>
      <td>大连黄金山大酒店 舒适型 3.4分/5分</td>
      <td>标准间 大/双床 不含早 1间2晚</td>
      <td>南方航空 CZ6833</td>
      <td>直飞</td>
      <td>09:10-12:40</td>
      <td>东海 DZ6242</td>
      <td>经停</td>
      <td>12:40-18:00</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python"># 补充目的地缺失值
df.loc[df.目的地.isnull(),'目的地'] = '大连'
</code></pre>
<pre><code class="language-python">df.目的地.isnull().sum()
</code></pre>
<pre><code>0
</code></pre>
<pre><code class="language-python"># 查看价格缺失值的行
df[df.价格.isnull()]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>哈尔滨</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>472.0</td>
      <td>哈尔滨-长沙3天2晚 | 入住长沙艾玛连锁酒店 + 海南航空/奥凯航空往返机票</td>
      <td>长沙艾玛连锁酒店 舒适型 3.7分/5分</td>
      <td>豪华双人间-不含早（预... 双床 不含早 1间2晚</td>
      <td>海南航空 HU7726</td>
      <td>经停</td>
      <td>16:25-22:05</td>
      <td>奥凯航空 BK2849</td>
      <td>经停</td>
      <td>07:15-12:50</td>
    </tr>
    <tr>
      <th>31</th>
      <td>天津</td>
      <td>西宁</td>
      <td>NaN</td>
      <td>396.0</td>
      <td>天津-西宁3天2晚 | 入住西宁运通商务宾馆 + 中国国航往返机票</td>
      <td>西宁运通商务宾馆 舒适型 4.4分/5分</td>
      <td>标准间(双床)(内宾) 双床 不含早 1间2晚</td>
      <td>中国国航 CA1241</td>
      <td>直飞</td>
      <td>15:25-17:55</td>
      <td>中国国航 CA8280</td>
      <td>经停</td>
      <td>18:15-22:05</td>
    </tr>
    <tr>
      <th>41</th>
      <td>南京</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>326.0</td>
      <td>南京-青岛3天2晚 | 入住宜必思酒店青岛城阳正阳路店 + 青岛航/首都航空往返...</td>
      <td>宜必思酒店青岛城阳正阳路店 4.4分/5分</td>
      <td>大床房(酒店★力推)(... 大床 不含早 1间2晚</td>
      <td>青岛航 QW9860</td>
      <td>直飞</td>
      <td>22:55-00:10</td>
      <td>首都航空 JD5298</td>
      <td>直飞</td>
      <td>10:40-12:00</td>
    </tr>
    <tr>
      <th>51</th>
      <td>青岛</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>454.0</td>
      <td>青岛-长沙3天2晚 | 入住长沙天洋大酒店 + 青岛航/幸福航空往返机票</td>
      <td>长沙天洋大酒店 3.9分/5分</td>
      <td>标准大床房[无早] 大床 不含早 1间2晚</td>
      <td>青岛航 QW9775</td>
      <td>直飞</td>
      <td>06:20-08:40</td>
      <td>幸福航空 JR2769</td>
      <td>直飞</td>
      <td>06:40-09:05</td>
    </tr>
    <tr>
      <th>73</th>
      <td>深圳</td>
      <td>呼和浩特</td>
      <td>NaN</td>
      <td>606.0</td>
      <td>深圳-呼和浩特3天2晚 | 入住呼和浩特凯基国际商务酒店 + 东方航空/深圳航空...</td>
      <td>呼和浩特凯基国际商务酒店 高档型 4.4分/5分</td>
      <td>豪华双人间 双床 双床 不含早 1间2晚</td>
      <td>东方航空 MU2877</td>
      <td>经停</td>
      <td>11:05-17:00</td>
      <td>深圳航空 ZH9128</td>
      <td>经停</td>
      <td>13:55-18:40</td>
    </tr>
    <tr>
      <th>117</th>
      <td>广州</td>
      <td>西宁</td>
      <td>NaN</td>
      <td>990.0</td>
      <td>广州-西宁3天2晚 | 入住锦江之星品尚酒店西宁五四西路新华联广场店 + 南方航...</td>
      <td>锦江之星品尚酒店西宁五四西路新华联广场店 舒适型 4.1分/5分</td>
      <td>商务房B(内宾)(特惠... 大床 不含早 1间2晚</td>
      <td>南方航空 CZ3249</td>
      <td>直飞</td>
      <td>06:30-10:10</td>
      <td>南方航空 CZ3130</td>
      <td>经停</td>
      <td>13:55-18:40</td>
    </tr>
    <tr>
      <th>118</th>
      <td>成都</td>
      <td>厦门</td>
      <td>NaN</td>
      <td>530.0</td>
      <td>成都-厦门3天2晚 | 入住厦门温泉戴斯酒店 + 四川航空/山东航空往返机票</td>
      <td>厦门温泉戴斯酒店 高档型 4.3分/5分</td>
      <td>氧吧大床房（无窗)(特... 大床 双早 1间2晚</td>
      <td>四川航空 3U8869</td>
      <td>直飞</td>
      <td>08:00-10:40</td>
      <td>山东航空 SC4763</td>
      <td>经停</td>
      <td>06:15-10:15</td>
    </tr>
    <tr>
      <th>385</th>
      <td>哈尔滨</td>
      <td>西宁</td>
      <td>NaN</td>
      <td>612.0</td>
      <td>哈尔滨-西宁3天2晚 | 入住锦江之星品尚酒店西宁火车站店 + 成都航空往返机票</td>
      <td>锦江之星品尚酒店西宁火车站店 舒适型 4.8分/5分</td>
      <td>商务标准房C 其他 不含早 1间2晚</td>
      <td>成都航空 EU2282</td>
      <td>直飞</td>
      <td>19:20-23:05</td>
      <td>成都航空 EU2281</td>
      <td>直飞</td>
      <td>15:00-18:30</td>
    </tr>
    <tr>
      <th>615</th>
      <td>大连</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>424.0</td>
      <td>大连-长沙3天2晚 | 入住长沙天成国际大酒店 + 奥凯航空往返机票</td>
      <td>长沙天成国际大酒店 高档型 3.8分/5分</td>
      <td>特惠双床房（小窗） 双床 双早 1间2晚</td>
      <td>奥凯航空 BK2842</td>
      <td>经停</td>
      <td>13:00-17:30</td>
      <td>奥凯航空 BK2841</td>
      <td>经停</td>
      <td>07:25-12:00</td>
    </tr>
    <tr>
      <th>810</th>
      <td>重庆</td>
      <td>鼓浪屿</td>
      <td>NaN</td>
      <td>470.0</td>
      <td>重庆-鼓浪屿3天2晚 | 入住厦门帝乐酒店 + 西藏航空/厦门航空往返机票</td>
      <td>厦门帝乐酒店 舒适型 4.1分/5分</td>
      <td>行政客房 双床 双床 双早 1间2晚</td>
      <td>西藏航空 TV9869</td>
      <td>直飞</td>
      <td>18:35-21:10</td>
      <td>厦门航空 MF8403</td>
      <td>经停</td>
      <td>06:50-10:45</td>
    </tr>
    <tr>
      <th>921</th>
      <td>重庆</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>420.0</td>
      <td>重庆-青岛3天2晚 | 入住青岛宏运东都大酒店 + 华夏航空/四川航空往返机票</td>
      <td>青岛宏运东都大酒店 4.5分/5分</td>
      <td>特惠房(无窗)(双床) 双床 不含早 1间2晚</td>
      <td>华夏航空 G54710</td>
      <td>经停</td>
      <td>18:00-22:25</td>
      <td>四川航空 3U8232</td>
      <td>直飞</td>
      <td>23:10-01:55</td>
    </tr>
    <tr>
      <th>1072</th>
      <td>西安</td>
      <td>天津</td>
      <td>NaN</td>
      <td>350.0</td>
      <td>西安-天津3天2晚 | 入住天津中心Today酒店式公寓 + 奥凯航空往返机票</td>
      <td>天津中心Today酒店式公寓 舒适型 4.5分/5分</td>
      <td>精品大床房(预付) 大床 不含早 1间2晚</td>
      <td>奥凯航空 BK2883</td>
      <td>直飞</td>
      <td>06:20-08:25</td>
      <td>奥凯航空 BK2884</td>
      <td>直飞</td>
      <td>22:30-00:40</td>
    </tr>
    <tr>
      <th>1367</th>
      <td>天津</td>
      <td>桂林</td>
      <td>NaN</td>
      <td>474.0</td>
      <td>天津-桂林3天2晚 | 入住龙胜神龙客栈 + 奥凯航空往返机票</td>
      <td>龙胜神龙客栈 经济型 0.0分/5分</td>
      <td>标准间-不含早（预付） 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2917</td>
      <td>直飞</td>
      <td>10:30-13:20</td>
      <td>奥凯航空 BK2820</td>
      <td>直飞</td>
      <td>11:35-14:30</td>
    </tr>
    <tr>
      <th>1475</th>
      <td>上海</td>
      <td>丽江</td>
      <td>NaN</td>
      <td>570.0</td>
      <td>上海-丽江3天2晚 | 入住丽江古城柳暗花明客栈 + 首都航空/东方航空往返机票</td>
      <td>丽江古城柳暗花明客栈 经济型 4.8分/5分</td>
      <td>百花筑（标准间)-不含... 双床 不含早 1间2晚</td>
      <td>首都航空 JD5666</td>
      <td>直飞</td>
      <td>20:10-23:55</td>
      <td>东方航空 MU5820</td>
      <td>直飞</td>
      <td>09:00-12:30</td>
    </tr>
    <tr>
      <th>1591</th>
      <td>大连</td>
      <td>厦门</td>
      <td>NaN</td>
      <td>746.0</td>
      <td>大连-厦门3天2晚 | 入住厦门北站站前客栈 + 山东航空往返机票</td>
      <td>厦门北站站前客栈 经济型 4.8分/5分</td>
      <td>清新大床房-预付--北... 大床 不含早 1间2晚</td>
      <td>山东航空 SC8796</td>
      <td>经停</td>
      <td>12:30-17:35</td>
      <td>山东航空 SC8795</td>
      <td>经停</td>
      <td>07:20-11:45</td>
    </tr>
    <tr>
      <th>1799</th>
      <td>武汉</td>
      <td>重庆</td>
      <td>NaN</td>
      <td>336.0</td>
      <td>武汉-重庆3天2晚 | 入住重庆市外贸宾馆 + 华夏航空/东方航空往返机票</td>
      <td>重庆市外贸宾馆 舒适型 4.4分/5分</td>
      <td>经济房(内宾)(大床) 大床 双早 1间2晚</td>
      <td>华夏航空 G52910</td>
      <td>经停</td>
      <td>17:55-00:25</td>
      <td>东方航空 MU2540</td>
      <td>直飞</td>
      <td>23:10-00:35</td>
    </tr>
    <tr>
      <th>2116</th>
      <td>哈尔滨</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>364.0</td>
      <td>哈尔滨-青岛3天2晚 | 入住青岛影都海岸海景度假公寓万达东方影都店 + 青岛航...</td>
      <td>青岛影都海岸海景度假公寓万达东方影都店 舒适型 0.0分/5分</td>
      <td>影都园景大床房 大床 不含早 1间2晚</td>
      <td>青岛航 QW9784</td>
      <td>直飞</td>
      <td>22:45-00:50</td>
      <td>福州 FU6658</td>
      <td>直飞</td>
      <td>22:20-00:20</td>
    </tr>
    <tr>
      <th>2338</th>
      <td>杭州</td>
      <td>北海</td>
      <td>NaN</td>
      <td>794.0</td>
      <td>杭州-北海3天2晚 | 入住北海石林大酒店 + 南方航空往返机票</td>
      <td>北海石林大酒店 4.0分/5分</td>
      <td>标准间（低楼层）(双床) 双床 双早 1间2晚</td>
      <td>南方航空 CZ3266</td>
      <td>经停</td>
      <td>13:55-18:15</td>
      <td>南方航空 CZ3265</td>
      <td>经停</td>
      <td>08:35-12:40</td>
    </tr>
    <tr>
      <th>3092</th>
      <td>济南</td>
      <td>沈阳</td>
      <td>NaN</td>
      <td>334.0</td>
      <td>济南-沈阳3天2晚 | 入住沈阳途家盛捷鑫汇国际服务公寓 + 首都航空/山东航空...</td>
      <td>沈阳途家盛捷鑫汇国际服务公寓 舒适型 4.6分/5分</td>
      <td>高级舒适双床房(清凉一... 双床 不含早 1间2晚</td>
      <td>首都航空 JD5348</td>
      <td>直飞</td>
      <td>16:00-17:35</td>
      <td>山东航空 SC1162</td>
      <td>直飞</td>
      <td>18:20-20:05</td>
    </tr>
    <tr>
      <th>3243</th>
      <td>厦门</td>
      <td>营口</td>
      <td>NaN</td>
      <td>602.0</td>
      <td>厦门-营口3天2晚 | 入住营口新红运酒店 + 海南航空往返机票</td>
      <td>营口新红运酒店 高档型 4.2分/5分</td>
      <td>主题房（无窗）(大床) 大床 双早 1间2晚</td>
      <td>海南航空 HU7047</td>
      <td>直飞</td>
      <td>09:55-13:20</td>
      <td>海南航空 HU7048</td>
      <td>直飞</td>
      <td>14:15-17:45</td>
    </tr>
    <tr>
      <th>3314</th>
      <td>宁波</td>
      <td>青岛</td>
      <td>NaN</td>
      <td>372.0</td>
      <td>宁波-青岛3天2晚 | 入住青岛盛泰德大酒店 + 山东航空往返机票</td>
      <td>青岛盛泰德大酒店 舒适型 4.3分/5分</td>
      <td>经济大床房(无窗)-即... 大床 不含早 1间2晚</td>
      <td>山东航空 SC4884</td>
      <td>直飞</td>
      <td>22:25-00:05</td>
      <td>山东航空 SC4883</td>
      <td>直飞</td>
      <td>07:35-09:25</td>
    </tr>
    <tr>
      <th>3471</th>
      <td>南京</td>
      <td>成都</td>
      <td>NaN</td>
      <td>554.0</td>
      <td>南京-成都3天2晚 | 入住崇州拉菲飞龙酒店 + 东方航空/西藏航空往返机票</td>
      <td>崇州拉菲飞龙酒店 舒适型 4.5分/5分</td>
      <td>B栋安静大床房（无电梯... 大床 双早 1间2晚</td>
      <td>东方航空 MU2880</td>
      <td>直飞</td>
      <td>21:55-00:35</td>
      <td>西藏航空 TV9839</td>
      <td>直飞</td>
      <td>06:30-08:55</td>
    </tr>
    <tr>
      <th>3611</th>
      <td>天津</td>
      <td>长沙</td>
      <td>NaN</td>
      <td>366.0</td>
      <td>天津-长沙3天2晚 | 入住长沙翔云君泰大酒店 + 南方航空/奥凯航空往返机票</td>
      <td>长沙翔云君泰大酒店 舒适型 4.5分/5分</td>
      <td>豪华双间(预付)(双床) 双床 不含早 1间2晚</td>
      <td>南方航空 CZ3126</td>
      <td>直飞</td>
      <td>22:55-01:20</td>
      <td>奥凯航空 BK2932</td>
      <td>直飞</td>
      <td>22:25-00:40</td>
    </tr>
    <tr>
      <th>3724</th>
      <td>沈阳</td>
      <td>九寨沟</td>
      <td>NaN</td>
      <td>474.0</td>
      <td>沈阳-九寨沟3天2晚 | 入住九顶山国际大酒店 + 西藏航空/成都航空往返机票</td>
      <td>九顶山国际大酒店 高档型 3.9分/5分</td>
      <td>特惠房[双早](双床) 双床 双早 1间2晚</td>
      <td>西藏航空 TV9880</td>
      <td>直飞</td>
      <td>21:10-00:55</td>
      <td>成都航空 EU2765</td>
      <td>经停</td>
      <td>13:35-19:10</td>
    </tr>
    <tr>
      <th>3789</th>
      <td>宁波</td>
      <td>大连</td>
      <td>NaN</td>
      <td>380.0</td>
      <td>宁波-大连3天2晚 | 入住大连橡树公馆 + 南方航空/海南航空往返机票</td>
      <td>大连橡树公馆 高档型 4.8分/5分</td>
      <td>温馨客房(限量抢购)(... 大床 不含早 1间2晚</td>
      <td>南方航空 CZ6326</td>
      <td>直飞</td>
      <td>17:55-20:05</td>
      <td>海南航空 HU7718</td>
      <td>直飞</td>
      <td>07:00-09:00</td>
    </tr>
    <tr>
      <th>3841</th>
      <td>成都</td>
      <td>杭州</td>
      <td>NaN</td>
      <td>472.0</td>
      <td>成都-杭州3天2晚 | 入住千岛湖外高桥大酒店 + 长龙航空/厦门航空往返机票</td>
      <td>千岛湖外高桥大酒店 4.1分/5分</td>
      <td>标准房(预付)(双床) 双床 双早 1间2晚</td>
      <td>长龙航空 GJ8680</td>
      <td>经停</td>
      <td>20:25-00:50</td>
      <td>厦门航空 MF8423</td>
      <td>直飞</td>
      <td>08:10-11:05</td>
    </tr>
    <tr>
      <th>3913</th>
      <td>重庆</td>
      <td>西安</td>
      <td>NaN</td>
      <td>334.0</td>
      <td>重庆-西安3天2晚 | 入住西安秦皇客栈 + 首都航空/西部航空往返机票</td>
      <td>西安秦皇客栈 经济型 4.5分/5分</td>
      <td>大床房 大床 不含早 1间2晚</td>
      <td>首都航空 JD5102</td>
      <td>直飞</td>
      <td>10:45-12:05</td>
      <td>西部航空 PN6222</td>
      <td>直飞</td>
      <td>23:50-01:20</td>
    </tr>
    <tr>
      <th>3962</th>
      <td>青岛</td>
      <td>西安</td>
      <td>NaN</td>
      <td>334.0</td>
      <td>青岛-西安3天2晚 | 入住西安申鹏国际商务酒店东大街机场大巴店 + 首都航空/...</td>
      <td>西安申鹏国际商务酒店东大街机场大巴店 4.0分/5分</td>
      <td>经济标准间(预付价格)... 双床 不含早 1间2晚</td>
      <td>首都航空 JD5756</td>
      <td>直飞</td>
      <td>22:10-00:20</td>
      <td>华夏航空 G58816</td>
      <td>直飞</td>
      <td>23:10-01:20</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-python">sns.distplot(df['价格'].dropna(), kde = True)
</code></pre>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd070fcb710&gt;
</code></pre>
<figure data-type="image" tabindex="2"><img src="output_65_1.png" alt="png" loading="lazy"></figure>
<pre><code class="language-python">sns.distplot(df['节省'].dropna(), kde = True)
</code></pre>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd040232d90&gt;
</code></pre>
<figure data-type="image" tabindex="3"><img src="output_66_1.png" alt="png" loading="lazy"></figure>
<p>可以看出，价格和节省两列数据均呈右偏分布，缺失值不多，用中位数填充较好。</p>
<pre><code class="language-python">df['价格'].fillna(round(df['价格'].median(),0), inplace = True)
df['节省'].fillna(round(df['节省'].median(),0), inplace = True)
</code></pre>
<pre><code class="language-python">df.isnull().sum()
</code></pre>
<pre><code>出发地     0
目的地     0
价格      0
节省      0
路线名     0
酒店      0
房间      0
去程航司    0
去程方式    0
去程时间    0
回程航司    0
回程方式    0
回程时间    0
dtype: int64
</code></pre>
<p>所有行的缺失值已处理完毕。</p>
<h2 id="5文本型数据的处理">5.文本型数据的处理</h2>
<p>文本型数据处理多使用正则表达式</p>
<pre><code class="language-python">df.head(10)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>哈尔滨</td>
      <td>北海</td>
      <td>2208.0</td>
      <td>650.0</td>
      <td>哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票</td>
      <td>北海祥丰嘉年华大酒店 舒适型 4.7分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8741</td>
      <td>直飞</td>
      <td>17:10-21:50</td>
      <td>春秋航空 9C8742</td>
      <td>直飞</td>
      <td>10:20-15:05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1145.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票</td>
      <td>7天酒店丽江古城中心店 经济型 4.0分/5分</td>
      <td>经济房-不含早-限时特... 其他 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>广州</td>
      <td>沈阳</td>
      <td>2702.0</td>
      <td>618.0</td>
      <td>广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票</td>
      <td>沈阳中煤宾馆 舒适型 4.5分/5分</td>
      <td>大床间(内宾) 大床 双早 1间2晚</td>
      <td>南方航空 CZ6384</td>
      <td>直飞</td>
      <td>08:05-11:45</td>
      <td>深圳航空 ZH9652</td>
      <td>经停</td>
      <td>08:20-13:05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>上海</td>
      <td>九寨沟</td>
      <td>1954.0</td>
      <td>484.0</td>
      <td>上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票</td>
      <td>红原芸谊大酒店 舒适型 4.6分/5分</td>
      <td>豪华双床房[双早] 双床 双早 1间2晚</td>
      <td>成都航空 EU6678</td>
      <td>直飞</td>
      <td>21:55-01:15</td>
      <td>成都航空 EU6677</td>
      <td>直飞</td>
      <td>17:45-20:35</td>
    </tr>
    <tr>
      <th>4</th>
      <td>广州</td>
      <td>天津</td>
      <td>1608.0</td>
      <td>422.0</td>
      <td>广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票</td>
      <td>天津逸海明珠大酒店 高档型 4.1分/5分</td>
      <td>豪华双床房(预付) 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2787</td>
      <td>直飞</td>
      <td>06:55-10:00</td>
      <td>海南航空 HU7201</td>
      <td>直飞</td>
      <td>20:15-23:25</td>
    </tr>
    <tr>
      <th>5</th>
      <td>长春</td>
      <td>青岛</td>
      <td>1580.0</td>
      <td>390.0</td>
      <td>长春-青岛3天2晚 | 入住青岛康大豪生大酒店 + 南方航空往返机票</td>
      <td>青岛康大豪生大酒店 豪华型 4.6分/5分</td>
      <td>精选房(大床)[酒店★... 大床 不含早 1间2晚</td>
      <td>南方航空 CZ3938</td>
      <td>直飞</td>
      <td>20:00-21:55</td>
      <td>南方航空 CZ3963</td>
      <td>直飞</td>
      <td>15:40-17:30</td>
    </tr>
    <tr>
      <th>6</th>
      <td>济南</td>
      <td>九寨沟</td>
      <td>1625.0</td>
      <td>396.0</td>
      <td>济南-九寨沟3天2晚 | 入住阿坝松潘松林酒店 + 中国国航/成都航空往返机票</td>
      <td>阿坝松潘松林酒店 舒适型 4.3分/5分</td>
      <td>豪华标准间(双床) 双床 不含早 1间2晚</td>
      <td>中国国航 CA4528</td>
      <td>直飞</td>
      <td>21:00-23:30</td>
      <td>成都航空 EU2719</td>
      <td>直飞</td>
      <td>06:55-09:25</td>
    </tr>
    <tr>
      <th>7</th>
      <td>宁波</td>
      <td>重庆</td>
      <td>1673.0</td>
      <td>404.0</td>
      <td>宁波-重庆3天2晚 | 入住重庆运通假日酒店汽博中心店 + 南方航空/四川航空往...</td>
      <td>重庆运通假日酒店汽博中心店 舒适型 4.3分/5分</td>
      <td>特惠房(大床) 大床 双早 1间2晚</td>
      <td>南方航空 CZ8116</td>
      <td>直飞</td>
      <td>17:15-19:40</td>
      <td>四川航空 3U8983</td>
      <td>直飞</td>
      <td>06:55-09:35</td>
    </tr>
    <tr>
      <th>8</th>
      <td>哈尔滨</td>
      <td>南京</td>
      <td>1170.0</td>
      <td>340.0</td>
      <td>哈尔滨-南京3天2晚 | 入住维也纳酒店南京南站汇景店 + 吉祥航空/厦门航空往...</td>
      <td>维也纳酒店南京南站汇景店 舒适型 4.4分/5分</td>
      <td>特惠大床房（无窗）[双... 大床 双早 1间2晚</td>
      <td>吉祥航空 HO1651</td>
      <td>直飞</td>
      <td>17:10-20:00</td>
      <td>厦门航空 MF8067</td>
      <td>直飞</td>
      <td>19:40-22:25</td>
    </tr>
    <tr>
      <th>9</th>
      <td>深圳</td>
      <td>厦门</td>
      <td>1311.0</td>
      <td>350.0</td>
      <td>深圳-厦门3天2晚 | 入住厦门泊旅时尚酒店会展中心店 + 海南航空往返机票</td>
      <td>厦门泊旅时尚酒店会展中心店 舒适型 4.0分/5分</td>
      <td>时尚标准双床房 双床 双早 1间2晚</td>
      <td>海南航空 HU7065</td>
      <td>直飞</td>
      <td>07:30-08:40</td>
      <td>海南航空 HU7066</td>
      <td>直飞</td>
      <td>15:30-16:40</td>
    </tr>
  </tbody>
</table>
</div>
<p>我们还想知道每个预定对应者在旅游地停留的天数，需要从文本特征中提取形如 3天 这样的字符串。</p>
<pre><code>1）可以利用 str.extract() 方法。
2）利用正则表达式 (\d+)天\d晚 进行匹配
</code></pre>
<pre><code class="language-python"># 提取天数
df['天数'] = df['路线名'].str.extract('(\d+)天\d晚', expand = False)
</code></pre>
<p>同时，还想知道预定酒店的等级和对应评分。同样使用 str.extract()方法。</p>
<pre><code class="language-python"># 提取酒店等级
df['酒店等级'] = df['酒店'].str.extract(' (.+) ', expand = False)
</code></pre>
<pre><code class="language-python"># 提取酒店评分
df['酒店评分'] = df['酒店'].str.extract('(\d\.\d)分/5分',expand=False)
</code></pre>
<pre><code class="language-python">df.head()
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://leezhiwl.GitHub.io/post-images/%E5%8E%BB%E5%93%AA%E5%84%BF%E7%BD%91df.head.png" alt="" loading="lazy"></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>出发地</th>
      <th>目的地</th>
      <th>价格</th>
      <th>节省</th>
      <th>路线名</th>
      <th>酒店</th>
      <th>房间</th>
      <th>去程航司</th>
      <th>去程方式</th>
      <th>去程时间</th>
      <th>回程航司</th>
      <th>回程方式</th>
      <th>回程时间</th>
      <th>天数</th>
      <th>酒店等级</th>
      <th>酒店评分</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>哈尔滨</td>
      <td>北海</td>
      <td>2208.0</td>
      <td>650.0</td>
      <td>哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票</td>
      <td>北海祥丰嘉年华大酒店 舒适型 4.7分/5分</td>
      <td>标准双人间(双床) 双床 不含早 1间2晚</td>
      <td>春秋航空 9C8741</td>
      <td>直飞</td>
      <td>17:10-21:50</td>
      <td>春秋航空 9C8742</td>
      <td>直飞</td>
      <td>10:20-15:05</td>
      <td>3</td>
      <td>舒适型</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>成都</td>
      <td>泸沽湖</td>
      <td>1145.0</td>
      <td>376.0</td>
      <td>成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票</td>
      <td>7天酒店丽江古城中心店 经济型 4.0分/5分</td>
      <td>经济房-不含早-限时特... 其他 不含早 1间2晚</td>
      <td>成都航空 EU2237</td>
      <td>直飞</td>
      <td>19:45-21:20</td>
      <td>成都航空 EU2738</td>
      <td>直飞</td>
      <td>23:30-01:05</td>
      <td>3</td>
      <td>经济型</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>广州</td>
      <td>沈阳</td>
      <td>2702.0</td>
      <td>618.0</td>
      <td>广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票</td>
      <td>沈阳中煤宾馆 舒适型 4.5分/5分</td>
      <td>大床间(内宾) 大床 双早 1间2晚</td>
      <td>南方航空 CZ6384</td>
      <td>直飞</td>
      <td>08:05-11:45</td>
      <td>深圳航空 ZH9652</td>
      <td>经停</td>
      <td>08:20-13:05</td>
      <td>3</td>
      <td>舒适型</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>上海</td>
      <td>九寨沟</td>
      <td>1954.0</td>
      <td>484.0</td>
      <td>上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票</td>
      <td>红原芸谊大酒店 舒适型 4.6分/5分</td>
      <td>豪华双床房[双早] 双床 双早 1间2晚</td>
      <td>成都航空 EU6678</td>
      <td>直飞</td>
      <td>21:55-01:15</td>
      <td>成都航空 EU6677</td>
      <td>直飞</td>
      <td>17:45-20:35</td>
      <td>3</td>
      <td>舒适型</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>广州</td>
      <td>天津</td>
      <td>1608.0</td>
      <td>422.0</td>
      <td>广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票</td>
      <td>天津逸海明珠大酒店 高档型 4.1分/5分</td>
      <td>豪华双床房(预付) 双床 不含早 1间2晚</td>
      <td>奥凯航空 BK2787</td>
      <td>直飞</td>
      <td>06:55-10:00</td>
      <td>海南航空 HU7201</td>
      <td>直飞</td>
      <td>20:15-23:25</td>
      <td>3</td>
      <td>高档型</td>
      <td>4.1</td>
    </tr>
  </tbody>
</table>
</div>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://leezhiwl.GitHub.io/post/hello-gridea/</id>
        <link href="https://leezhiwl.GitHub.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>👏  欢迎使用 <strong>Gridea</strong> ！<br>
✍️  <strong>Gridea</strong> 一个静态博客写作客户端。你可以用它来记录你的生活、心情、知识、笔记、创意... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>👏  欢迎使用 <strong>Gridea</strong> ！<br>
✍️  <strong>Gridea</strong> 一个静态博客写作客户端。你可以用它来记录你的生活、心情、知识、笔记、创意... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea 主页</a><br>
<a href="http://fehey.com/">示例网站</a></p>
<h2 id="特性">特性👇</h2>
<p>📝  你可以使用最酷的 <strong>Markdown</strong> 语法，进行快速创作</p>
<p>🌉  你可以给文章配上精美的封面图和在文章任意位置插入图片</p>
<p>🏷️  你可以对文章进行标签分组</p>
<p>📋  你可以自定义菜单，甚至可以创建外部链接菜单</p>
<p>💻  你可以在 <strong>Windows</strong>，<strong>MacOS</strong> 或 <strong>Linux</strong> 设备上使用此客户端</p>
<p>🌎  你可以使用 <strong>𝖦𝗂𝗍𝗁𝗎𝖻 𝖯𝖺𝗀𝖾𝗌</strong> 或 <strong>Coding Pages</strong> 向世界展示，未来将支持更多平台</p>
<p>💬  你可以进行简单的配置，接入 <a href="https://github.com/gitalk/gitalk">Gitalk</a> 或 <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> 评论系统</p>
<p>🇬🇧  你可以使用<strong>中文简体</strong>或<strong>英语</strong></p>
<p>🌁  你可以任意使用应用内默认主题或任意第三方主题，强大的主题自定义能力</p>
<p>🖥  你可以自定义源文件夹，利用 OneDrive、百度网盘、iCloud、Dropbox 等进行多设备同步</p>
<p>🌱 当然 <strong>Gridea</strong> 还很年轻，有很多不足，但请相信，它会不停向前 🏃</p>
<p>未来，它一定会成为你离不开的伙伴</p>
<p>尽情发挥你的才华吧！</p>
<p>😘 Enjoy~</p>
]]></content>
    </entry>
</feed>