{"posts":[{"title":"去哪儿网数据清洗","content":"去哪儿网数据清洗 1&nbsp;&nbsp;数据预览1.1&nbsp;&nbsp;数据导入和概览1.1.1&nbsp;&nbsp;加载数据分析需要使用的科学计算库1.1.2&nbsp;&nbsp;读取文件1.1.3&nbsp;&nbsp;查看一下行列数量1.1.4&nbsp;&nbsp;简单浏览下数据1.1.5&nbsp;&nbsp;看下数据的大概分布1.1.6&nbsp;&nbsp;describe( )展示一些基本信息1.1.7&nbsp;&nbsp;查看有没有重复值1.1.8&nbsp;&nbsp;看看列名2&nbsp;&nbsp;数据清洗2.1&nbsp;&nbsp;“列名”清洗2.2&nbsp;&nbsp;重复值处理2.2.1&nbsp;&nbsp;判断重复行2.2.2&nbsp;&nbsp;重复行清洗2.3&nbsp;&nbsp;异常值处理2.3.1&nbsp;&nbsp;异常值列概览2.3.2&nbsp;&nbsp;“价格”异常值清洗2.3.3&nbsp;&nbsp;“节省”异常值清洗2.3.4&nbsp;&nbsp;检验删除异常值后的数据基本特征2.4&nbsp;&nbsp;缺失值处理2.4.1&nbsp;&nbsp;查看缺失值情况2.4.2&nbsp;&nbsp;“出发地”缺失值处理2.4.3&nbsp;&nbsp;“目的地”缺失值处理2.4.4&nbsp;&nbsp;“价格”和“节省”缺失值处理2.4.5&nbsp;&nbsp;检验缺失值处理完成情况2.5&nbsp;&nbsp;文本型数据的处理 数据预览 数据导入和概览 加载数据分析需要使用的科学计算库 # 忽略warning错误 import warnings warnings.filterwarnings(&quot;ignore&quot;) import pandas as pd import matplotlib.pyplot as plt import seaborn as sns plt.style.use('fivethirtyeight') sns.set_style({'font.sans-serif':['simhei','Arial']}) %matplotlib inline 读取文件 df = pd.read_csv('./qunar_freetrip.csv',index_col=0) 查看一下行列数量 df.shape (5100, 13) 简单浏览下数据 df.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 看下数据的大概分布 df.info() &lt;class 'pandas.core.frame.DataFrame'&gt; Int64Index: 5100 entries, 0 to 5099 Data columns (total 13 columns): # Column Non-Null Count Dtype --- ------ -------------- ----- 0 出发地 5098 non-null object 1 目的地 5099 non-null object 2 价格 5072 non-null float64 3 节省 5083 non-null float64 4 路线名 5100 non-null object 5 酒店 5100 non-null object 6 房间 5100 non-null object 7 去程航司 5100 non-null object 8 去程方式 5100 non-null object 9 去程时间 5100 non-null object 10 回程航司 5100 non-null object 11 回程方式 5100 non-null object 12 回程时间 5100 non-null object dtypes: float64(2), object(11) memory usage: 557.8+ KB &quot;出发地&quot;、&quot;目的地&quot;、&quot;价格&quot;、&quot;节省&quot; 四列有缺失值，需要清洗。 describe( )展示一些基本信息 df.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 价格 节省 count 5072.000000 5083.000000 mean 1765.714905 474.139878 std 2580.129644 168.893780 min 578.000000 306.000000 25% 1253.000000 358.000000 50% 1632.000000 436.000000 75% 2028.250000 530.000000 max 179500.000000 3500.000000 ”价格“和”节省“两列中数据的最大值异常大，价格有十七万，需要检验是否为异常值。 查看有没有重复值 df.duplicated().sum() 100 有重复的行，后续可直接删除。 看看列名 df.columns Index(['出发地 ', ' 目的地', '价格 ', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式', '去程时间', '回程航司', '回程方式 ', '回程时间'], dtype='object') 列名中有空格，需要清洗 数据清洗 “列名”清洗 # 处理列名空字符 df.columns = [x.strip() for x in df.columns] # 再查看 df.columns Index(['出发地', '目的地', '价格', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式', '去程时间', '回程航司', '回程方式', '回程时间'], dtype='object') 重复值处理 判断重复行 # 查看重复行 df.duplicated().sum() 100 # 展示重复行的记录 df[df.duplicated()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 454 广州 黄山 1871.0 492.0 广州-黄山3天2晚 | 入住黄山汤口醉享主题酒店 + 南方航空往返机票 黄山汤口醉享主题酒店 舒适型 4.8分/5分 睫毛弯弯(大床) 大床 不含早 1间2晚 南方航空 CZ3627 直飞 19:20-21:15 南方航空 CZ3628 直飞 22:05-23:50 649 济南 长沙 1134.0 360.0 济南-长沙3天2晚 | 入住长沙喜迎宾华天大酒店 + 山东航空往返机票 长沙喜迎宾华天大酒店 高档型 3.7分/5分 特惠双间(特惠抢购)(... 双床 不含早 1间2晚 山东航空 SC1185 直飞 18:40-20:50 山东航空 SC1186 直飞 10:20-12:15 685 青岛 重庆 1474.0 420.0 青岛-重庆3天2晚 | 入住怡家丽景酒店重庆垫江店 + 山东航空/华夏航空往返机票 怡家丽景酒店重庆垫江店 舒适型 4.3分/5分 法式房(内宾)(无窗)... 大床 不含早 1间2晚 山东航空 SC4709 经停 19:30-00:05 华夏航空 G54710 经停 18:00-22:25 852 北京 哈尔滨 1450.0 368.0 北京-哈尔滨3天2晚 | 入住哈尔滨水逸城市酒店 + 南方航空/大新华航空往返机票 哈尔滨水逸城市酒店 舒适型 4.6分/5分 标准间-【预付特惠】独... 双床 双早 1间2晚 南方航空 CZ6202 直飞 22:20-00:20 大新华航空 CN7150 直飞 22:50-00:55 922 北京 长沙 1289.0 334.0 北京-长沙3天2晚 | 入住浏阳市华尔宫大酒店 + 海南航空/南方航空往返机票 浏阳市华尔宫大酒店 3.8分/5分 豪华双人间(双床) 双床 不含早 1间2晚 海南航空 HU7135 直飞 17:45-20:30 南方航空 CZ3855 直飞 22:55-01:10 ... ... ... ... ... ... ... ... ... ... ... ... ... ... 5045 杭州 丽江 2872.0 718.0 杭州-丽江3天2晚 | 入住丽江松竹居客栈玉观音店 + 长龙航空/首都航空往返机票 丽江松竹居客栈玉观音店 高档型 4.6分/5分 特惠房(大床) 大床 不含早 1间2晚 长龙航空 GJ8869 经停 08:50-13:35 首都航空 JD5192 直飞 13:00-16:15 5066 哈尔滨 西安 1843.0 450.0 哈尔滨-西安3天2晚 | 入住西安铁通商务酒店贵宾楼 + 天津航空/东方航空往返... 西安铁通商务酒店贵宾楼 舒适型 4.2分/5分 标准间(持房卡尊享清凉... 双床 不含早 1间2晚 天津航空 GS7584 经停 12:30-17:40 东方航空 MU2211 经停 08:45-13:25 5068 南京 成都 1922.0 552.0 南京-成都3天2晚 | 入住成都伊丽特酒店 + 东方航空/西藏航空往返机票 成都伊丽特酒店 高档型 4.5分/5分 行政标准间-含早立即确... 双床 双早 1间2晚 东方航空 MU2880 直飞 21:55-00:35 西藏航空 TV9839 直飞 06:30-08:55 5081 上海 青岛 769.0 354.0 上海-青岛3天2晚 | 入住青岛金中太大酒店 + 春秋航空/吉祥航空往返机票 青岛金中太大酒店 舒适型 4.8分/5分 特惠大床房[无早] 大床 不含早 1间2晚 春秋航空 9C8853 直飞 19:50-21:35 吉祥航空 HO1242 直飞 23:05-00:35 5095 宁波 九寨沟 2085.0 562.0 宁波-九寨沟3天2晚 | 入住黑水县达古冰山国际大酒店 + 成都航空/四川航空往... 黑水县达古冰山国际大酒店 豪华型 3.9分/5分 B区豪华标间(双床) 双床 不含早 1间2晚 成都航空 EU2730 经停 19:45-00:45 四川航空 3U8927 经停 07:55-12:15 100 rows × 13 columns 判断有100行重复数据，直接进行去重。 重复行清洗 # 删除重读行 df.drop_duplicates(inplace=True) # 再查看 df.shape (5000, 13) 异常值处理 异常值列概览 df.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 价格 节省 count 4972.000000 4983.000000 mean 1767.782381 474.490869 std 2604.329780 169.148391 min 578.000000 306.000000 25% 1253.000000 358.000000 50% 1633.000000 436.000000 75% 2031.000000 532.000000 max 179500.000000 3500.000000 “价格”异常值清洗 # 展示价格异常值的记录 # 根据正态分布的特性，可以将3σ之外的数据，视为异常值。 df[abs((df.价格-df.价格.mean())/df.价格.std())&gt;3] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 2792 杭州 九寨沟 179500.0 538.0 杭州-九寨沟3天2晚 | 入住九寨沟九乡宾馆 + 成都航空/长龙航空往返机票 九寨沟九乡宾馆 舒适型 4.3分/5分 特惠房(双床) 双床 不含早 1间2晚 成都航空 EU2206 经停 20:30-01:00 长龙航空 GJ8680 经停 20:25-00:50 # 删除价格异常值 df.drop(df[abs((df.价格-df.价格.mean())/df.价格.std())&gt;3].index,inplace=True) “节省”异常值清洗 # 探索异常值情况 df.head(15) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 5 长春 青岛 1580.0 390.0 长春-青岛3天2晚 | 入住青岛康大豪生大酒店 + 南方航空往返机票 青岛康大豪生大酒店 豪华型 4.6分/5分 精选房(大床)[酒店★... 大床 不含早 1间2晚 南方航空 CZ3938 直飞 20:00-21:55 南方航空 CZ3963 直飞 15:40-17:30 6 济南 九寨沟 1625.0 396.0 济南-九寨沟3天2晚 | 入住阿坝松潘松林酒店 + 中国国航/成都航空往返机票 阿坝松潘松林酒店 舒适型 4.3分/5分 豪华标准间(双床) 双床 不含早 1间2晚 中国国航 CA4528 直飞 21:00-23:30 成都航空 EU2719 直飞 06:55-09:25 7 宁波 重庆 1673.0 404.0 宁波-重庆3天2晚 | 入住重庆运通假日酒店汽博中心店 + 南方航空/四川航空往... 重庆运通假日酒店汽博中心店 舒适型 4.3分/5分 特惠房(大床) 大床 双早 1间2晚 南方航空 CZ8116 直飞 17:15-19:40 四川航空 3U8983 直飞 06:55-09:35 8 哈尔滨 南京 1170.0 340.0 哈尔滨-南京3天2晚 | 入住维也纳酒店南京南站汇景店 + 吉祥航空/厦门航空往... 维也纳酒店南京南站汇景店 舒适型 4.4分/5分 特惠大床房（无窗）[双... 大床 双早 1间2晚 吉祥航空 HO1651 直飞 17:10-20:00 厦门航空 MF8067 直飞 19:40-22:25 9 深圳 厦门 1311.0 350.0 深圳-厦门3天2晚 | 入住厦门泊旅时尚酒店会展中心店 + 海南航空往返机票 厦门泊旅时尚酒店会展中心店 舒适型 4.0分/5分 时尚标准双床房 双床 双早 1间2晚 海南航空 HU7065 直飞 07:30-08:40 海南航空 HU7066 直飞 15:30-16:40 10 厦门 沈阳 2231.0 606.0 厦门-沈阳3天2晚 | 入住沈阳东方银座国际酒店 + 深圳航空/海南航空往返机票 沈阳东方银座国际酒店 高档型 4.4分/5分 高级大床房(空气清新房... 大床 不含早 1间2晚 深圳航空 ZH9704 经停 17:20-22:10 海南航空 HU7048 直飞 14:15-17:45 11 哈尔滨 长沙 NaN 472.0 哈尔滨-长沙3天2晚 | 入住长沙艾玛连锁酒店 + 海南航空/奥凯航空往返机票 长沙艾玛连锁酒店 舒适型 3.7分/5分 豪华双人间-不含早（预... 双床 不含早 1间2晚 海南航空 HU7726 经停 16:25-22:05 奥凯航空 BK2849 经停 07:15-12:50 12 重庆 厦门 1780.0 486.0 重庆-厦门3天2晚 | 入住宜尚酒店厦门机场高科技园店 + 西藏航空/厦门航空往... 宜尚酒店厦门机场高科技园店 舒适型 4.5分/5分 商务大床房 大床 双早 1间2晚 西藏航空 TV9869 直飞 18:35-21:10 厦门航空 MF8403 经停 06:50-10:45 13 杭州 西双版纳 1665.0 516.0 杭州-西双版纳3天2晚 | 入住西双版纳辉煌都畅大饭店 + 长龙航空/首都航空往... 西双版纳辉煌都畅大饭店 3.9分/5分 高级双床房[无早] 双床 不含早 1间2晚 长龙航空 GJ8823 经停 13:55-18:55 首都航空 JD5788 直飞 21:40-00:50 14 青岛 长沙 1784.0 450.0 青岛-长沙3天2晚 | 入住林之源酒店长沙井湾子店 + 青岛航/幸福航空往返机票 林之源酒店长沙井湾子店 舒适型 4.3分/5分 标准双人间(双床) 双床 不含早 1间2晚 青岛航 QW9775 直飞 06:20-08:40 幸福航空 JR2769 直飞 06:40-09:05 (df.价格&gt;df.节省).sum() 4951 价格大于节省符合常理，反之则为异常。以上数据说明有48行票价优惠比原价高，不合常理，判断为异常值，数据较少，在此处直接去除。 # 删除节省列异常值 df.drop(df[df.价格&lt;df.节省].index,inplace=True) 检验删除异常值后的数据基本特征 df.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 价格 节省 count 4968.000000 4979.000000 mean 1732.514090 472.779675 std 653.148583 154.366206 min 578.000000 306.000000 25% 1253.750000 358.000000 50% 1633.000000 436.000000 75% 2031.000000 530.000000 max 6279.000000 1640.000000 缺失值处理 查看缺失值情况 df.isnull().sum() 出发地 2 目的地 1 价格 28 节省 17 路线名 0 酒店 0 房间 0 去程航司 0 去程方式 0 去程时间 0 回程航司 0 回程方式 0 回程时间 0 dtype: int64 “出发地”缺失值处理 # 展示“出发地”有缺失值的记录 df[df.出发地.isnull()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 1864 NaN 烟台 647.0 348.0 大连-烟台3天2晚 | 入住烟台海阳黄金海岸大酒店 + 幸福航空/天津航空往返机票 烟台海阳黄金海岸大酒店 3.7分/5分 海景标准间(内宾)[双... 双床 双早 1间2晚 幸福航空 JR1582 直飞 10:05-11:05 天津航空 GS6402 直飞 16:30-17:25 1930 NaN 西安 1030.0 326.0 济南-西安3天2晚 | 入住西安丝路秦国际青年旅舍钟楼回民街店 + 华夏航空往返... 西安丝路秦国际青年旅舍钟楼回民街店 经济型 4.4分/5分 标准间（独卫）-吃货天... 双床 不含早 1间2晚 华夏航空 G54963 直飞 07:10-08:55 华夏航空 G58858 直飞 23:10-00:55 # 补充路线名的缺失值 # 路线名的前两个字为出发地 df.loc[df.出发地.isnull(),&quot;出发地&quot;] = [x[:2] for x in df.loc[df.出发地.isnull(),&quot;路线名&quot;]] # 再查看 df.出发地.isnull().sum() 0 “目的地”缺失值处理 # 展示“目的地”有缺失值的记录 df[df.目的地.isnull()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 1875 深圳 NaN 2149.0 494.0 深圳-大连3天2晚 | 入住大连黄金山大酒店 + 南方航空/东海往返机票 大连黄金山大酒店 舒适型 3.4分/5分 标准间 大/双床 不含早 1间2晚 南方航空 CZ6833 直飞 09:10-12:40 东海 DZ6242 经停 12:40-18:00 # 补充目的地缺失值 df.loc[df.目的地.isnull(),'目的地'] = '大连' # 再查看 df.目的地.isnull().sum() 0 # 检验价格缺失值的记录是否清洗完成 df[df.目的地.isnull()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 “价格”和“节省”缺失值处理 # 先绘图看看数据分布情况 sns.distplot(df['价格'].dropna(), kde = True) &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f9ac02c5710&gt; sns.distplot(df['节省'].dropna(), kde = True) &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f9af8d11c50&gt; 可以看出，价格和节省两列数据均呈右偏分布，缺失值不多，用中位数填充较好。 df['价格'].fillna(round(df['价格'].median(),0), inplace = True) df['节省'].fillna(round(df['节省'].median(),0), inplace = True) 检验缺失值处理完成情况 df.isnull().sum() 出发地 0 目的地 0 价格 0 节省 0 路线名 0 酒店 0 房间 0 去程航司 0 去程方式 0 去程时间 0 回程航司 0 回程方式 0 回程时间 0 dtype: int64 所有行的缺失值已处理完毕。 至此数据清洗基本处理完毕，我们看到路线名里包含的信息比较丰富，接下来还可以提取居停时间和居住酒店信息出来，做进一步分析。 文本型数据的处理 文本型数据处理多使用正则表达式 df.head(10) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 5 长春 青岛 1580.0 390.0 长春-青岛3天2晚 | 入住青岛康大豪生大酒店 + 南方航空往返机票 青岛康大豪生大酒店 豪华型 4.6分/5分 精选房(大床)[酒店★... 大床 不含早 1间2晚 南方航空 CZ3938 直飞 20:00-21:55 南方航空 CZ3963 直飞 15:40-17:30 6 济南 九寨沟 1625.0 396.0 济南-九寨沟3天2晚 | 入住阿坝松潘松林酒店 + 中国国航/成都航空往返机票 阿坝松潘松林酒店 舒适型 4.3分/5分 豪华标准间(双床) 双床 不含早 1间2晚 中国国航 CA4528 直飞 21:00-23:30 成都航空 EU2719 直飞 06:55-09:25 7 宁波 重庆 1673.0 404.0 宁波-重庆3天2晚 | 入住重庆运通假日酒店汽博中心店 + 南方航空/四川航空往... 重庆运通假日酒店汽博中心店 舒适型 4.3分/5分 特惠房(大床) 大床 双早 1间2晚 南方航空 CZ8116 直飞 17:15-19:40 四川航空 3U8983 直飞 06:55-09:35 8 哈尔滨 南京 1170.0 340.0 哈尔滨-南京3天2晚 | 入住维也纳酒店南京南站汇景店 + 吉祥航空/厦门航空往... 维也纳酒店南京南站汇景店 舒适型 4.4分/5分 特惠大床房（无窗）[双... 大床 双早 1间2晚 吉祥航空 HO1651 直飞 17:10-20:00 厦门航空 MF8067 直飞 19:40-22:25 9 深圳 厦门 1311.0 350.0 深圳-厦门3天2晚 | 入住厦门泊旅时尚酒店会展中心店 + 海南航空往返机票 厦门泊旅时尚酒店会展中心店 舒适型 4.0分/5分 时尚标准双床房 双床 双早 1间2晚 海南航空 HU7065 直飞 07:30-08:40 海南航空 HU7066 直飞 15:30-16:40 我们还想知道每个预定对应者在旅游地停留的天数，需要从文本特征中提取形如 “3天” 这样的字符串。 1）可以利用 str.extract() 方法。 2）利用正则表达式 (\\d+)天\\d晚 进行匹配 # 提取天数 df['天数'] = df['路线名'].str.extract('(\\d+)天\\d晚', expand = False) 同时，还想知道预定酒店的等级和对应评分。同样使用 str.extract()方法。 # 提取酒店等级 df['酒店等级'] = df['酒店'].str.extract(' (.+) ', expand = False) # 提取酒店评分 df['酒店评分'] = df['酒店'].str.extract('(\\d\\.\\d)分/5分',expand=False) # 展示提取出天数、酒店等级、酒店评分的部分记录 df.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 天数 酒店等级 酒店评分 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 3 舒适型 4.7 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 3 经济型 4.0 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 舒适型 4.5 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 3 舒适型 4.6 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 3 高档型 4.1 酒店评分绘图展示 sns.distplot(df['酒店评分'].astype(float), kde = True) &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f9af8d8bc50&gt; 酒店评分基本呈正态分布，4分和4.5分的评分记录最多。 酒店等级分布图 sns.countplot(df['酒店等级']) &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f9af8ef9c50&gt; 出行酒店绝大多数都选择了舒适型。 ","link":"https://leezhiwl.github.io/post/qu-na-er-wang-shu-ju-qing-xi/"}]}