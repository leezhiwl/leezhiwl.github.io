{"posts":[{"title":"去哪儿网数据清洗","content":"去哪儿网数据清理 一、数据清洗1. 数据导入和概览二、数据预处理1. 列名空字符去除2. 重复值处理3. 异常值处理4. 缺失值处理5.文本型数据的处理 一、数据清洗 1. 数据导入和概览 导入相关数据计算包： import numpy as np import pandas as pd import matplotlib.pyplot as plt import seaborn as sns sns.set_style({'font.sans-serif':['simhei','Arial']}) sns.set(style=&quot;white&quot;, palette=&quot;muted&quot;, color_codes=True) %matplotlib inline /opt/anaconda3/lib/python3.7/site-packages/statsmodels/tools/_testing.py:19: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead. import pandas.util.testing as tm 从csv文件中导入数据到jupyter notebook： df = pd.read_csv('./qunar_freetrip.csv',index_col=0) 查看数据形状，原数据共5100行，13列： df.shape (5100, 13) 查看数据前5行: df.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 查看数据结构(列名、行数、字段类型): df.info() &lt;class 'pandas.core.frame.DataFrame'&gt; Int64Index: 5100 entries, 0 to 5099 Data columns (total 13 columns): # Column Non-Null Count Dtype --- ------ -------------- ----- 0 出发地 5098 non-null object 1 目的地 5099 non-null object 2 价格 5072 non-null float64 3 节省 5083 non-null float64 4 路线名 5100 non-null object 5 酒店 5100 non-null object 6 房间 5100 non-null object 7 去程航司 5100 non-null object 8 去程方式 5100 non-null object 9 去程时间 5100 non-null object 10 回程航司 5100 non-null object 11 回程方式 5100 non-null object 12 回程时间 5100 non-null object dtypes: float64(2), object(11) memory usage: 557.8+ KB 出发地、目的地、价格、节省四列数据有缺失，后续需要处理缺失值。 查看数值型数据的描述统计信息： df.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 价格 节省 count 5072.000000 5083.000000 mean 1765.714905 474.139878 std 2580.129644 168.893780 min 578.000000 306.000000 25% 1253.000000 358.000000 50% 1632.000000 436.000000 75% 2028.250000 530.000000 max 179500.000000 3500.000000 价格和节省两列中数据最大值有点异常大，后续确认是否为异常值。 再看看列名，列名中有空格，需要先去除： df.columns Index(['出发地 ', ' 目的地', '价格 ', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式', '去程时间', '回程航司', '回程方式 ', '回程时间'], dtype='object') 二、数据预处理 1. 列名空字符去除 df.columns = [x.strip() for x in df.columns] df.columns Index(['出发地', '目的地', '价格', '节省', '路线名', '酒店', '房间', '去程航司', '去程方式', '去程时间', '回程航司', '回程方式', '回程时间'], dtype='object') 2. 重复值处理 df.duplicated().sum() 100 df[df.duplicated()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 454 广州 黄山 1871.0 492.0 广州-黄山3天2晚 | 入住黄山汤口醉享主题酒店 + 南方航空往返机票 黄山汤口醉享主题酒店 舒适型 4.8分/5分 睫毛弯弯(大床) 大床 不含早 1间2晚 南方航空 CZ3627 直飞 19:20-21:15 南方航空 CZ3628 直飞 22:05-23:50 649 济南 长沙 1134.0 360.0 济南-长沙3天2晚 | 入住长沙喜迎宾华天大酒店 + 山东航空往返机票 长沙喜迎宾华天大酒店 高档型 3.7分/5分 特惠双间(特惠抢购)(... 双床 不含早 1间2晚 山东航空 SC1185 直飞 18:40-20:50 山东航空 SC1186 直飞 10:20-12:15 685 青岛 重庆 1474.0 420.0 青岛-重庆3天2晚 | 入住怡家丽景酒店重庆垫江店 + 山东航空/华夏航空往返机票 怡家丽景酒店重庆垫江店 舒适型 4.3分/5分 法式房(内宾)(无窗)... 大床 不含早 1间2晚 山东航空 SC4709 经停 19:30-00:05 华夏航空 G54710 经停 18:00-22:25 852 北京 哈尔滨 1450.0 368.0 北京-哈尔滨3天2晚 | 入住哈尔滨水逸城市酒店 + 南方航空/大新华航空往返机票 哈尔滨水逸城市酒店 舒适型 4.6分/5分 标准间-【预付特惠】独... 双床 双早 1间2晚 南方航空 CZ6202 直飞 22:20-00:20 大新华航空 CN7150 直飞 22:50-00:55 922 北京 长沙 1289.0 334.0 北京-长沙3天2晚 | 入住浏阳市华尔宫大酒店 + 海南航空/南方航空往返机票 浏阳市华尔宫大酒店 3.8分/5分 豪华双人间(双床) 双床 不含早 1间2晚 海南航空 HU7135 直飞 17:45-20:30 南方航空 CZ3855 直飞 22:55-01:10 ... ... ... ... ... ... ... ... ... ... ... ... ... ... 5045 杭州 丽江 2872.0 718.0 杭州-丽江3天2晚 | 入住丽江松竹居客栈玉观音店 + 长龙航空/首都航空往返机票 丽江松竹居客栈玉观音店 高档型 4.6分/5分 特惠房(大床) 大床 不含早 1间2晚 长龙航空 GJ8869 经停 08:50-13:35 首都航空 JD5192 直飞 13:00-16:15 5066 哈尔滨 西安 1843.0 450.0 哈尔滨-西安3天2晚 | 入住西安铁通商务酒店贵宾楼 + 天津航空/东方航空往返... 西安铁通商务酒店贵宾楼 舒适型 4.2分/5分 标准间(持房卡尊享清凉... 双床 不含早 1间2晚 天津航空 GS7584 经停 12:30-17:40 东方航空 MU2211 经停 08:45-13:25 5068 南京 成都 1922.0 552.0 南京-成都3天2晚 | 入住成都伊丽特酒店 + 东方航空/西藏航空往返机票 成都伊丽特酒店 高档型 4.5分/5分 行政标准间-含早立即确... 双床 双早 1间2晚 东方航空 MU2880 直飞 21:55-00:35 西藏航空 TV9839 直飞 06:30-08:55 5081 上海 青岛 769.0 354.0 上海-青岛3天2晚 | 入住青岛金中太大酒店 + 春秋航空/吉祥航空往返机票 青岛金中太大酒店 舒适型 4.8分/5分 特惠大床房[无早] 大床 不含早 1间2晚 春秋航空 9C8853 直飞 19:50-21:35 吉祥航空 HO1242 直飞 23:05-00:35 5095 宁波 九寨沟 2085.0 562.0 宁波-九寨沟3天2晚 | 入住黑水县达古冰山国际大酒店 + 成都航空/四川航空往... 黑水县达古冰山国际大酒店 豪华型 3.9分/5分 B区豪华标间(双床) 双床 不含早 1间2晚 成都航空 EU2730 经停 19:45-00:45 四川航空 3U8927 经停 07:55-12:15 100 rows × 13 columns 判断有100行重复数据，直接进行去重。 df.drop_duplicates(inplace=True) df.shape (5000, 13) 3. 异常值处理 对价格和节省两列数据进行异常值处理： df.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 价格 节省 count 4972.000000 4983.000000 mean 1767.782381 474.490869 std 2604.329780 169.148391 min 578.000000 306.000000 25% 1253.000000 358.000000 50% 1633.000000 436.000000 75% 2031.000000 532.000000 max 179500.000000 3500.000000 找出价格异常值： df[abs((df.价格-df.价格.mean())/df.价格.std())&gt;3] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 2792 杭州 九寨沟 179500.0 538.0 杭州-九寨沟3天2晚 | 入住九寨沟九乡宾馆 + 成都航空/长龙航空往返机票 九寨沟九乡宾馆 舒适型 4.3分/5分 特惠房(双床) 双床 不含早 1间2晚 成都航空 EU2206 经停 20:30-01:00 长龙航空 GJ8680 经停 20:25-00:50 删除价格异常值： df.drop(df[abs((df.价格-df.价格.mean())/df.价格.std())&gt;3].index,inplace=True) 找出节省异常值： df.head(15) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 5 长春 青岛 1580.0 390.0 长春-青岛3天2晚 | 入住青岛康大豪生大酒店 + 南方航空往返机票 青岛康大豪生大酒店 豪华型 4.6分/5分 精选房(大床)[酒店★... 大床 不含早 1间2晚 南方航空 CZ3938 直飞 20:00-21:55 南方航空 CZ3963 直飞 15:40-17:30 6 济南 九寨沟 1625.0 396.0 济南-九寨沟3天2晚 | 入住阿坝松潘松林酒店 + 中国国航/成都航空往返机票 阿坝松潘松林酒店 舒适型 4.3分/5分 豪华标准间(双床) 双床 不含早 1间2晚 中国国航 CA4528 直飞 21:00-23:30 成都航空 EU2719 直飞 06:55-09:25 7 宁波 重庆 1673.0 404.0 宁波-重庆3天2晚 | 入住重庆运通假日酒店汽博中心店 + 南方航空/四川航空往... 重庆运通假日酒店汽博中心店 舒适型 4.3分/5分 特惠房(大床) 大床 双早 1间2晚 南方航空 CZ8116 直飞 17:15-19:40 四川航空 3U8983 直飞 06:55-09:35 8 哈尔滨 南京 1170.0 340.0 哈尔滨-南京3天2晚 | 入住维也纳酒店南京南站汇景店 + 吉祥航空/厦门航空往... 维也纳酒店南京南站汇景店 舒适型 4.4分/5分 特惠大床房（无窗）[双... 大床 双早 1间2晚 吉祥航空 HO1651 直飞 17:10-20:00 厦门航空 MF8067 直飞 19:40-22:25 9 深圳 厦门 1311.0 350.0 深圳-厦门3天2晚 | 入住厦门泊旅时尚酒店会展中心店 + 海南航空往返机票 厦门泊旅时尚酒店会展中心店 舒适型 4.0分/5分 时尚标准双床房 双床 双早 1间2晚 海南航空 HU7065 直飞 07:30-08:40 海南航空 HU7066 直飞 15:30-16:40 10 厦门 沈阳 2231.0 606.0 厦门-沈阳3天2晚 | 入住沈阳东方银座国际酒店 + 深圳航空/海南航空往返机票 沈阳东方银座国际酒店 高档型 4.4分/5分 高级大床房(空气清新房... 大床 不含早 1间2晚 深圳航空 ZH9704 经停 17:20-22:10 海南航空 HU7048 直飞 14:15-17:45 11 哈尔滨 长沙 NaN 472.0 哈尔滨-长沙3天2晚 | 入住长沙艾玛连锁酒店 + 海南航空/奥凯航空往返机票 长沙艾玛连锁酒店 舒适型 3.7分/5分 豪华双人间-不含早（预... 双床 不含早 1间2晚 海南航空 HU7726 经停 16:25-22:05 奥凯航空 BK2849 经停 07:15-12:50 12 重庆 厦门 1780.0 486.0 重庆-厦门3天2晚 | 入住宜尚酒店厦门机场高科技园店 + 西藏航空/厦门航空往... 宜尚酒店厦门机场高科技园店 舒适型 4.5分/5分 商务大床房 大床 双早 1间2晚 西藏航空 TV9869 直飞 18:35-21:10 厦门航空 MF8403 经停 06:50-10:45 13 杭州 西双版纳 1665.0 516.0 杭州-西双版纳3天2晚 | 入住西双版纳辉煌都畅大饭店 + 长龙航空/首都航空往... 西双版纳辉煌都畅大饭店 3.9分/5分 高级双床房[无早] 双床 不含早 1间2晚 长龙航空 GJ8823 经停 13:55-18:55 首都航空 JD5788 直飞 21:40-00:50 14 青岛 长沙 1784.0 450.0 青岛-长沙3天2晚 | 入住林之源酒店长沙井湾子店 + 青岛航/幸福航空往返机票 林之源酒店长沙井湾子店 舒适型 4.3分/5分 标准双人间(双床) 双床 不含早 1间2晚 青岛航 QW9775 直飞 06:20-08:40 幸福航空 JR2769 直飞 06:40-09:05 (df.价格&gt;df.节省).sum() 4951 说明有48行票价优惠比原价高，不合常理，判断为异常值，数据较少，也可以直接去除。 删除节省列异常值： df.drop(df[df.价格&lt;df.节省].index,inplace=True) 检验删除异常值后的数据基本特征： df.describe() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 价格 节省 count 4968.000000 4979.000000 mean 1732.514090 472.779675 std 653.148583 154.366206 min 578.000000 306.000000 25% 1253.750000 358.000000 50% 1633.000000 436.000000 75% 2031.000000 530.000000 max 6279.000000 1640.000000 4. 缺失值处理 df.isnull().sum() 出发地 2 目的地 1 价格 28 节省 17 路线名 0 酒店 0 房间 0 去程航司 0 去程方式 0 去程时间 0 回程航司 0 回程方式 0 回程时间 0 dtype: int64 # 查看出发地缺失值行 df[df.出发地.isnull()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 1864 NaN 烟台 647.0 348.0 大连-烟台3天2晚 | 入住烟台海阳黄金海岸大酒店 + 幸福航空/天津航空往返机票 烟台海阳黄金海岸大酒店 3.7分/5分 海景标准间(内宾)[双... 双床 双早 1间2晚 幸福航空 JR1582 直飞 10:05-11:05 天津航空 GS6402 直飞 16:30-17:25 1930 NaN 西安 1030.0 326.0 济南-西安3天2晚 | 入住西安丝路秦国际青年旅舍钟楼回民街店 + 华夏航空往返... 西安丝路秦国际青年旅舍钟楼回民街店 经济型 4.4分/5分 标准间（独卫）-吃货天... 双床 不含早 1间2晚 华夏航空 G54963 直飞 07:10-08:55 华夏航空 G58858 直飞 23:10-00:55 # 路线名的前两个字为出发地 df.loc[df.出发地.isnull(),&quot;出发地&quot;] = [x[:2] for x in df.loc[df.出发地.isnull(),&quot;路线名&quot;]] df.出发地.isnull().sum() 0 # 查看目的地缺失值行 df[df.目的地.isnull()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 1875 深圳 NaN 2149.0 494.0 深圳-大连3天2晚 | 入住大连黄金山大酒店 + 南方航空/东海往返机票 大连黄金山大酒店 舒适型 3.4分/5分 标准间 大/双床 不含早 1间2晚 南方航空 CZ6833 直飞 09:10-12:40 东海 DZ6242 经停 12:40-18:00 # 补充目的地缺失值 df.loc[df.目的地.isnull(),'目的地'] = '大连' df.目的地.isnull().sum() 0 # 查看价格缺失值的行 df[df.价格.isnull()] .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 11 哈尔滨 长沙 NaN 472.0 哈尔滨-长沙3天2晚 | 入住长沙艾玛连锁酒店 + 海南航空/奥凯航空往返机票 长沙艾玛连锁酒店 舒适型 3.7分/5分 豪华双人间-不含早（预... 双床 不含早 1间2晚 海南航空 HU7726 经停 16:25-22:05 奥凯航空 BK2849 经停 07:15-12:50 31 天津 西宁 NaN 396.0 天津-西宁3天2晚 | 入住西宁运通商务宾馆 + 中国国航往返机票 西宁运通商务宾馆 舒适型 4.4分/5分 标准间(双床)(内宾) 双床 不含早 1间2晚 中国国航 CA1241 直飞 15:25-17:55 中国国航 CA8280 经停 18:15-22:05 41 南京 青岛 NaN 326.0 南京-青岛3天2晚 | 入住宜必思酒店青岛城阳正阳路店 + 青岛航/首都航空往返... 宜必思酒店青岛城阳正阳路店 4.4分/5分 大床房(酒店★力推)(... 大床 不含早 1间2晚 青岛航 QW9860 直飞 22:55-00:10 首都航空 JD5298 直飞 10:40-12:00 51 青岛 长沙 NaN 454.0 青岛-长沙3天2晚 | 入住长沙天洋大酒店 + 青岛航/幸福航空往返机票 长沙天洋大酒店 3.9分/5分 标准大床房[无早] 大床 不含早 1间2晚 青岛航 QW9775 直飞 06:20-08:40 幸福航空 JR2769 直飞 06:40-09:05 73 深圳 呼和浩特 NaN 606.0 深圳-呼和浩特3天2晚 | 入住呼和浩特凯基国际商务酒店 + 东方航空/深圳航空... 呼和浩特凯基国际商务酒店 高档型 4.4分/5分 豪华双人间 双床 双床 不含早 1间2晚 东方航空 MU2877 经停 11:05-17:00 深圳航空 ZH9128 经停 13:55-18:40 117 广州 西宁 NaN 990.0 广州-西宁3天2晚 | 入住锦江之星品尚酒店西宁五四西路新华联广场店 + 南方航... 锦江之星品尚酒店西宁五四西路新华联广场店 舒适型 4.1分/5分 商务房B(内宾)(特惠... 大床 不含早 1间2晚 南方航空 CZ3249 直飞 06:30-10:10 南方航空 CZ3130 经停 13:55-18:40 118 成都 厦门 NaN 530.0 成都-厦门3天2晚 | 入住厦门温泉戴斯酒店 + 四川航空/山东航空往返机票 厦门温泉戴斯酒店 高档型 4.3分/5分 氧吧大床房（无窗)(特... 大床 双早 1间2晚 四川航空 3U8869 直飞 08:00-10:40 山东航空 SC4763 经停 06:15-10:15 385 哈尔滨 西宁 NaN 612.0 哈尔滨-西宁3天2晚 | 入住锦江之星品尚酒店西宁火车站店 + 成都航空往返机票 锦江之星品尚酒店西宁火车站店 舒适型 4.8分/5分 商务标准房C 其他 不含早 1间2晚 成都航空 EU2282 直飞 19:20-23:05 成都航空 EU2281 直飞 15:00-18:30 615 大连 长沙 NaN 424.0 大连-长沙3天2晚 | 入住长沙天成国际大酒店 + 奥凯航空往返机票 长沙天成国际大酒店 高档型 3.8分/5分 特惠双床房（小窗） 双床 双早 1间2晚 奥凯航空 BK2842 经停 13:00-17:30 奥凯航空 BK2841 经停 07:25-12:00 810 重庆 鼓浪屿 NaN 470.0 重庆-鼓浪屿3天2晚 | 入住厦门帝乐酒店 + 西藏航空/厦门航空往返机票 厦门帝乐酒店 舒适型 4.1分/5分 行政客房 双床 双床 双早 1间2晚 西藏航空 TV9869 直飞 18:35-21:10 厦门航空 MF8403 经停 06:50-10:45 921 重庆 青岛 NaN 420.0 重庆-青岛3天2晚 | 入住青岛宏运东都大酒店 + 华夏航空/四川航空往返机票 青岛宏运东都大酒店 4.5分/5分 特惠房(无窗)(双床) 双床 不含早 1间2晚 华夏航空 G54710 经停 18:00-22:25 四川航空 3U8232 直飞 23:10-01:55 1072 西安 天津 NaN 350.0 西安-天津3天2晚 | 入住天津中心Today酒店式公寓 + 奥凯航空往返机票 天津中心Today酒店式公寓 舒适型 4.5分/5分 精品大床房(预付) 大床 不含早 1间2晚 奥凯航空 BK2883 直飞 06:20-08:25 奥凯航空 BK2884 直飞 22:30-00:40 1367 天津 桂林 NaN 474.0 天津-桂林3天2晚 | 入住龙胜神龙客栈 + 奥凯航空往返机票 龙胜神龙客栈 经济型 0.0分/5分 标准间-不含早（预付） 双床 不含早 1间2晚 奥凯航空 BK2917 直飞 10:30-13:20 奥凯航空 BK2820 直飞 11:35-14:30 1475 上海 丽江 NaN 570.0 上海-丽江3天2晚 | 入住丽江古城柳暗花明客栈 + 首都航空/东方航空往返机票 丽江古城柳暗花明客栈 经济型 4.8分/5分 百花筑（标准间)-不含... 双床 不含早 1间2晚 首都航空 JD5666 直飞 20:10-23:55 东方航空 MU5820 直飞 09:00-12:30 1591 大连 厦门 NaN 746.0 大连-厦门3天2晚 | 入住厦门北站站前客栈 + 山东航空往返机票 厦门北站站前客栈 经济型 4.8分/5分 清新大床房-预付--北... 大床 不含早 1间2晚 山东航空 SC8796 经停 12:30-17:35 山东航空 SC8795 经停 07:20-11:45 1799 武汉 重庆 NaN 336.0 武汉-重庆3天2晚 | 入住重庆市外贸宾馆 + 华夏航空/东方航空往返机票 重庆市外贸宾馆 舒适型 4.4分/5分 经济房(内宾)(大床) 大床 双早 1间2晚 华夏航空 G52910 经停 17:55-00:25 东方航空 MU2540 直飞 23:10-00:35 2116 哈尔滨 青岛 NaN 364.0 哈尔滨-青岛3天2晚 | 入住青岛影都海岸海景度假公寓万达东方影都店 + 青岛航... 青岛影都海岸海景度假公寓万达东方影都店 舒适型 0.0分/5分 影都园景大床房 大床 不含早 1间2晚 青岛航 QW9784 直飞 22:45-00:50 福州 FU6658 直飞 22:20-00:20 2338 杭州 北海 NaN 794.0 杭州-北海3天2晚 | 入住北海石林大酒店 + 南方航空往返机票 北海石林大酒店 4.0分/5分 标准间（低楼层）(双床) 双床 双早 1间2晚 南方航空 CZ3266 经停 13:55-18:15 南方航空 CZ3265 经停 08:35-12:40 3092 济南 沈阳 NaN 334.0 济南-沈阳3天2晚 | 入住沈阳途家盛捷鑫汇国际服务公寓 + 首都航空/山东航空... 沈阳途家盛捷鑫汇国际服务公寓 舒适型 4.6分/5分 高级舒适双床房(清凉一... 双床 不含早 1间2晚 首都航空 JD5348 直飞 16:00-17:35 山东航空 SC1162 直飞 18:20-20:05 3243 厦门 营口 NaN 602.0 厦门-营口3天2晚 | 入住营口新红运酒店 + 海南航空往返机票 营口新红运酒店 高档型 4.2分/5分 主题房（无窗）(大床) 大床 双早 1间2晚 海南航空 HU7047 直飞 09:55-13:20 海南航空 HU7048 直飞 14:15-17:45 3314 宁波 青岛 NaN 372.0 宁波-青岛3天2晚 | 入住青岛盛泰德大酒店 + 山东航空往返机票 青岛盛泰德大酒店 舒适型 4.3分/5分 经济大床房(无窗)-即... 大床 不含早 1间2晚 山东航空 SC4884 直飞 22:25-00:05 山东航空 SC4883 直飞 07:35-09:25 3471 南京 成都 NaN 554.0 南京-成都3天2晚 | 入住崇州拉菲飞龙酒店 + 东方航空/西藏航空往返机票 崇州拉菲飞龙酒店 舒适型 4.5分/5分 B栋安静大床房（无电梯... 大床 双早 1间2晚 东方航空 MU2880 直飞 21:55-00:35 西藏航空 TV9839 直飞 06:30-08:55 3611 天津 长沙 NaN 366.0 天津-长沙3天2晚 | 入住长沙翔云君泰大酒店 + 南方航空/奥凯航空往返机票 长沙翔云君泰大酒店 舒适型 4.5分/5分 豪华双间(预付)(双床) 双床 不含早 1间2晚 南方航空 CZ3126 直飞 22:55-01:20 奥凯航空 BK2932 直飞 22:25-00:40 3724 沈阳 九寨沟 NaN 474.0 沈阳-九寨沟3天2晚 | 入住九顶山国际大酒店 + 西藏航空/成都航空往返机票 九顶山国际大酒店 高档型 3.9分/5分 特惠房[双早](双床) 双床 双早 1间2晚 西藏航空 TV9880 直飞 21:10-00:55 成都航空 EU2765 经停 13:35-19:10 3789 宁波 大连 NaN 380.0 宁波-大连3天2晚 | 入住大连橡树公馆 + 南方航空/海南航空往返机票 大连橡树公馆 高档型 4.8分/5分 温馨客房(限量抢购)(... 大床 不含早 1间2晚 南方航空 CZ6326 直飞 17:55-20:05 海南航空 HU7718 直飞 07:00-09:00 3841 成都 杭州 NaN 472.0 成都-杭州3天2晚 | 入住千岛湖外高桥大酒店 + 长龙航空/厦门航空往返机票 千岛湖外高桥大酒店 4.1分/5分 标准房(预付)(双床) 双床 双早 1间2晚 长龙航空 GJ8680 经停 20:25-00:50 厦门航空 MF8423 直飞 08:10-11:05 3913 重庆 西安 NaN 334.0 重庆-西安3天2晚 | 入住西安秦皇客栈 + 首都航空/西部航空往返机票 西安秦皇客栈 经济型 4.5分/5分 大床房 大床 不含早 1间2晚 首都航空 JD5102 直飞 10:45-12:05 西部航空 PN6222 直飞 23:50-01:20 3962 青岛 西安 NaN 334.0 青岛-西安3天2晚 | 入住西安申鹏国际商务酒店东大街机场大巴店 + 首都航空/... 西安申鹏国际商务酒店东大街机场大巴店 4.0分/5分 经济标准间(预付价格)... 双床 不含早 1间2晚 首都航空 JD5756 直飞 22:10-00:20 华夏航空 G58816 直飞 23:10-01:20 sns.distplot(df['价格'].dropna(), kde = True) &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f93eace6890&gt; /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:211: RuntimeWarning: Glyph 20215 missing from current font. font.set_text(s, 0.0, flags=flags) /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:211: RuntimeWarning: Glyph 26684 missing from current font. font.set_text(s, 0.0, flags=flags) /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:180: RuntimeWarning: Glyph 20215 missing from current font. font.set_text(s, 0, flags=flags) /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:180: RuntimeWarning: Glyph 26684 missing from current font. font.set_text(s, 0, flags=flags) sns.distplot(df['节省'].dropna(), kde = True) &lt;matplotlib.axes._subplots.AxesSubplot at 0x7f94086d0310&gt; /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:211: RuntimeWarning: Glyph 33410 missing from current font. font.set_text(s, 0.0, flags=flags) /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:211: RuntimeWarning: Glyph 30465 missing from current font. font.set_text(s, 0.0, flags=flags) /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:180: RuntimeWarning: Glyph 33410 missing from current font. font.set_text(s, 0, flags=flags) /opt/anaconda3/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py:180: RuntimeWarning: Glyph 30465 missing from current font. font.set_text(s, 0, flags=flags) 可以看出，价格和节省两列数据均呈右偏分布，缺失值不多，用中位数填充较好。 df['价格'].fillna(round(df['价格'].median(),0), inplace = True) df['节省'].fillna(round(df['节省'].median(),0), inplace = True) df.isnull().sum() 出发地 0 目的地 0 价格 0 节省 0 路线名 0 酒店 0 房间 0 去程航司 0 去程方式 0 去程时间 0 回程航司 0 回程方式 0 回程时间 0 dtype: int64 所有行的缺失值已处理完毕。 5.文本型数据的处理 文本型数据处理多使用正则表达式 df.head(10) .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 5 长春 青岛 1580.0 390.0 长春-青岛3天2晚 | 入住青岛康大豪生大酒店 + 南方航空往返机票 青岛康大豪生大酒店 豪华型 4.6分/5分 精选房(大床)[酒店★... 大床 不含早 1间2晚 南方航空 CZ3938 直飞 20:00-21:55 南方航空 CZ3963 直飞 15:40-17:30 6 济南 九寨沟 1625.0 396.0 济南-九寨沟3天2晚 | 入住阿坝松潘松林酒店 + 中国国航/成都航空往返机票 阿坝松潘松林酒店 舒适型 4.3分/5分 豪华标准间(双床) 双床 不含早 1间2晚 中国国航 CA4528 直飞 21:00-23:30 成都航空 EU2719 直飞 06:55-09:25 7 宁波 重庆 1673.0 404.0 宁波-重庆3天2晚 | 入住重庆运通假日酒店汽博中心店 + 南方航空/四川航空往... 重庆运通假日酒店汽博中心店 舒适型 4.3分/5分 特惠房(大床) 大床 双早 1间2晚 南方航空 CZ8116 直飞 17:15-19:40 四川航空 3U8983 直飞 06:55-09:35 8 哈尔滨 南京 1170.0 340.0 哈尔滨-南京3天2晚 | 入住维也纳酒店南京南站汇景店 + 吉祥航空/厦门航空往... 维也纳酒店南京南站汇景店 舒适型 4.4分/5分 特惠大床房（无窗）[双... 大床 双早 1间2晚 吉祥航空 HO1651 直飞 17:10-20:00 厦门航空 MF8067 直飞 19:40-22:25 9 深圳 厦门 1311.0 350.0 深圳-厦门3天2晚 | 入住厦门泊旅时尚酒店会展中心店 + 海南航空往返机票 厦门泊旅时尚酒店会展中心店 舒适型 4.0分/5分 时尚标准双床房 双床 双早 1间2晚 海南航空 HU7065 直飞 07:30-08:40 海南航空 HU7066 直飞 15:30-16:40 我们还想知道每个预定对应者在旅游地停留的天数，需要从文本特征中提取形如 3天 这样的字符串。 1）可以利用 str.extract() 方法。 2）利用正则表达式 (\\d+)天\\d晚 进行匹配 # 提取天数 df['天数'] = df['路线名'].str.extract('(\\d+)天\\d晚', expand = False) 同时，还想知道预定酒店的等级和对应评分。同样使用 str.extract()方法。 # 提取酒店等级 df['酒店等级'] = df['酒店'].str.extract(' (.+) ', expand = False) # 提取酒店评分 df['酒店评分'] = df['酒店'].str.extract('(\\d\\.\\d)分/5分',expand=False) df.head() .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 出发地 目的地 价格 节省 路线名 酒店 房间 去程航司 去程方式 去程时间 回程航司 回程方式 回程时间 天数 酒店等级 酒店评分 0 哈尔滨 北海 2208.0 650.0 哈尔滨-北海3天2晚 | 入住北海祥丰嘉年华大酒店 + 春秋航空往返机票 北海祥丰嘉年华大酒店 舒适型 4.7分/5分 标准双人间(双床) 双床 不含早 1间2晚 春秋航空 9C8741 直飞 17:10-21:50 春秋航空 9C8742 直飞 10:20-15:05 3 舒适型 4.7 1 成都 泸沽湖 1145.0 376.0 成都-泸沽湖3天2晚 | 入住7天酒店丽江古城中心店 + 成都航空往返机票 7天酒店丽江古城中心店 经济型 4.0分/5分 经济房-不含早-限时特... 其他 不含早 1间2晚 成都航空 EU2237 直飞 19:45-21:20 成都航空 EU2738 直飞 23:30-01:05 3 经济型 4.0 2 广州 沈阳 2702.0 618.0 广州-沈阳3天2晚 | 入住沈阳中煤宾馆 + 南方航空/深圳航空往返机票 沈阳中煤宾馆 舒适型 4.5分/5分 大床间(内宾) 大床 双早 1间2晚 南方航空 CZ6384 直飞 08:05-11:45 深圳航空 ZH9652 经停 08:20-13:05 3 舒适型 4.5 3 上海 九寨沟 1954.0 484.0 上海-九寨沟3天2晚 | 入住红原芸谊大酒店 + 成都航空往返机票 红原芸谊大酒店 舒适型 4.6分/5分 豪华双床房[双早] 双床 双早 1间2晚 成都航空 EU6678 直飞 21:55-01:15 成都航空 EU6677 直飞 17:45-20:35 3 舒适型 4.6 4 广州 天津 1608.0 422.0 广州-天津3天2晚 | 入住天津逸海明珠大酒店 + 奥凯航空/海南航空往返机票 天津逸海明珠大酒店 高档型 4.1分/5分 豪华双床房(预付) 双床 不含早 1间2晚 奥凯航空 BK2787 直飞 06:55-10:00 海南航空 HU7201 直飞 20:15-23:25 3 高档型 4.1 ","link":"https://leezhiwl.GitHub.io/post/qu-na-er-wang-shu-ju-qing-xi/"},{"title":"Hello Gridea","content":"👏 欢迎使用 Gridea ！ ✍️ Gridea 一个静态博客写作客户端。你可以用它来记录你的生活、心情、知识、笔记、创意... ... Github Gridea 主页 示例网站 特性👇 📝 你可以使用最酷的 Markdown 语法，进行快速创作 🌉 你可以给文章配上精美的封面图和在文章任意位置插入图片 🏷️ 你可以对文章进行标签分组 📋 你可以自定义菜单，甚至可以创建外部链接菜单 💻 你可以在 Windows，MacOS 或 Linux 设备上使用此客户端 🌎 你可以使用 𝖦𝗂𝗍𝗁𝗎𝖻 𝖯𝖺𝗀𝖾𝗌 或 Coding Pages 向世界展示，未来将支持更多平台 💬 你可以进行简单的配置，接入 Gitalk 或 DisqusJS 评论系统 🇬🇧 你可以使用中文简体或英语 🌁 你可以任意使用应用内默认主题或任意第三方主题，强大的主题自定义能力 🖥 你可以自定义源文件夹，利用 OneDrive、百度网盘、iCloud、Dropbox 等进行多设备同步 🌱 当然 Gridea 还很年轻，有很多不足，但请相信，它会不停向前 🏃 未来，它一定会成为你离不开的伙伴 尽情发挥你的才华吧！ 😘 Enjoy~ ","link":"https://leezhiwl.GitHub.io/post/hello-gridea/"}]}